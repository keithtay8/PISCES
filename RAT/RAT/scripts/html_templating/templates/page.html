<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
    <meta http-equiv="x-ua-compatible" content="ie=edge" />
    <title>PISCES - Report</title>
    <!-- Font Awesome        --><link rel="stylesheet" href="../../scripts/html_templating/templates/css/fontawesome.all.css" />
    <!-- Google Fonts Roboto --><link rel="stylesheet" href="../../scripts/html_templating/templates/css/google.robotofont.css2.css" />
    <!-- Bootstrap           --><link rel="stylesheet" href="../../scripts/html_templating/templates/css/Bootstrap/bootstrap.min.css" />
    <!-- MDB                 --><link rel="stylesheet" href="../../scripts/html_templating/templates/css/mdb.min.css" />
    <!-- PRISM               --><link rel="stylesheet" href="../../scripts/html_templating/templates/css/prism.css" />

    <style>
      [class*="col"] {
        padding: 1rem;
        /* border: 2px solid #33b5e5; */
        text-align: center;
      }

    .sidenav {
      position: fixed;
      z-index: 1;
      top: 60px;
      left: 30px;
      background: #eee;
      overflow-x: hidden;
      padding: 8px 0;
    }

    .sidenav a {
      padding: 6px 8px 6px 16px;
      text-decoration: none;
      font-size: 25px;
      color: #2196F3;
      display: block;
    }

    .sidenav a:hover {
      color: #064579;
    }

    .main {
      margin-left: 140px; /* Same width as the sidebar + left position in px */
      font-size: 28px; /* Increased text to enable scrolling */
      padding: 0px 10px;
    }

    @media screen and (max-height: 450px) {
      .sidenav {padding-top: 15px;}
      .sidenav a {font-size: 18px;}
    }

    #wrapper {
      padding-left: 250px;
      transition: all 0.4s ease 0s;
    }

    #sidebar-wrapper {
      margin-left: -250px;
      left: 250px;
      width: 250px;
      background: #CCC;
      position: fixed;
      height: 100%;
      overflow-y: auto;
      z-index: 1000;
      transition: all 0.4s ease 0s;
    }

    #page-content-wrapper {
      width: 100%;
    }

    .sidebar-nav {
      position: absolute;
      top: 0;
      width: 250px;
      list-style: none;
      margin: 0;
      padding: 0;
    }

    @media (max-width:767px) {

        #wrapper {
          padding-left: 0;
        }

        #sidebar-wrapper {
          left: 0;
        }

        #wrapper.active {
          position: relative;
          left: 250px;
        }

        #wrapper.active #sidebar-wrapper {
          left: 250px;
          width: 250px;
          transition: all 0.4s ease 0s;
        }

    }
    </style>

    <!-- Navbar -->
    <div class="row mb-3">
        <div class="col-12">
            <ul class="nav nav-tabs nav-fill fixed-top" id="myTab" role="tablist" style="background-color: #97f3f7;">
                {% set nav_lookup = {'os_lst': 'OS-related', 'ur_lst': 'User-related', 'pv_lst': 'Filesystem-related', 'xr_lst': 'Additional-Scripts'} %}
                {% set temp_count = namespace(counter=0) %}
                {% for key in dct.keys() %}
                    {% if key in nav_lookup %}
                        {% if temp_count.counter == 0 %}
                            {% set temp_count.counter = 1 %}
                <li class="nav-item active" role="presentation">
                    <a
                            class="nav-link active"
                            aria-selected="true"
                        {% else %}
                <li class="nav-item active" role="presentation">
                    <a
                            class="nav-link"
                            aria-selected="false"
                        {% endif %}
                            id="{{ key }}-tab"
                            data-mdb-toggle="tab"
                            href="#{{ key }}"
                            role="tab"
                            aria-controls="{{ key }}"
                    >{{ nav_lookup[key] }}</a
                    >
                </li>
                    {% endif %}
                {% endfor %}
                {% set temp_count = namespace(counter=0) %}
            </ul>
        </div>
    </div>
    <!-- Navbar: End -->
</head>

<body>
    <div class="tab-content">
        {% if 'os_lst' in dct %}
            {% if temp_count.counter == 0 %}
        <div class="tab-pane fade show active" id="os_lst" role="tabpanel" aria-labelledby="os_lst-tab">
                {% set temp_count.counter = 1 %}
            {% else %}
        <div class="tab-pane fade" id="os_lst" role="tabpanel" aria-labelledby="os_lst-tab">
            {% endif %}
            <div id="wrapper">
                <div id="sidebar-wrapper">
                    <ul class="sidebar-nav">
                        <li class="list-group-item"><a href="#get_osinfo">OS</a></li>
                        <li class="list-group-item"><a href="#get_display">Display Outputs</a></li>
                        <li class="list-group-item"><a href="#get_languages">Development Tools</a></li>
                        <li class="list-group-item"><a href="#get_networkinfo">Networking</a></li>
                        <li class="list-group-item"><a href="#get_filesystem">Filesystem</a></li>
                        <li class="list-group-item"><a href="#get_cron">Cron Tasks</a></li>
                        <li class="list-group-item"><a href="#get_envvar">ENV Variables</a></li>
                        <ul class="list-group-item" style="position: fixed; bottom: 0">
                            {% for item in info_dct %}
                            <li class="list-group-item"><strong>{{ item }}</strong>: <span style='float:right'>{{ info_dct[item] }}</span></li>
                            {% endfor %}
                        </ul>
                    </ul>
                </div>
                <div id="page-content-wrapper">
                    <div class="page-content">
                        <div class="container">
                            <div class="row">
                                <div class="col-md-12">
                                    <div class="container">
                                        <div class="row">
                                            <div class="col-md-5">
                                                <div class="row">
                                                    <div class="col-md">
                                                        <!--                   -->
                                                        <!-- get_osinfo: START -->
                                                        <!--                   -->
                                                        {% if 'get_osinfo' in dct['os_lst'] and dct['os_lst']['get_osinfo']['contents'] %}
                                                            {% set temp_dct = dct['os_lst']['get_osinfo'] %}
                                                            {% set get_osinfo = namespace(title=temp_dct['title'], os='', kernel='', hostname='') %}
                                                            {% for content_block in temp_dct['contents'] %}
                                                                {% for line in temp_dct['contents'][content_block] %}
                                                                    {% if 'operating system:' in line.lower() %}
                                                                        {% set get_osinfo.os = line['operating system:' | length :] %}
                                                                    {% elif 'kernel version:' in line.lower() %}
                                                                        {% set get_osinfo.kernel = line['kernel version:' | length :] %}
                                                                    {% elif 'hostname:' in line.lower() %}
                                                                        {% set get_osinfo.hostname = line['hostname:' | length :] %}
                                                                    {% endif %}
                                                                {% endfor %}
                                                            {% endfor %}
                                                        <div class="container border shadow-3" id="get_osinfo">
                                                            <section>
                                                                <h2 class="mb-0 text-center">{{ get_osinfo.title }}</h2>
                                                                <!-- Modal here -->
                                                                <button type="button" class="btn btn-primary waves-effect waves-light" data-mdb-toggle="modal" data-mdb-target="#OSModal" style="float: right">
                                                                    View Raw
                                                                </button>
                                                                <div class="modal fade" id="OSModal" tabindex="-1" role="dialog" aria-labelledby="OSModalLabel">
                                                                    <div class="modal-dialog modal-xl" role="document">
                                                                        <div class="modal-content">
                                                                            <div class="modal-header">
                                                                                <h5 class="modal-title" id="OSModalLabel">{{ temp_dct['title'] }} (Raw)</h5>
                                                                                <button type="button" class="btn-close" data-mdb-dismiss="modal" aria-label="Close"></button>
                                                                            </div>
                                                                            <div class="modal-body">
                                                                                <div class="code-toolbar">
                                                                                    <pre class="language-bash line-numbers"><code>{% for key in temp_dct['contents'] %}{{ "- " + key + " -\n" }}{% for line in temp_dct['contents'][key] %}{{ line + "\n" }}{% endfor %}{% endfor %}</code>
                                                                                    </pre>
                                                                                </div>
                                                                            </div>
                                                                            <div class="modal-footer">
                                                                                <button type="button" class="btn btn-secondary" data-mdb-dismiss="modal">Close</button>
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                                <!-- Modal closed --><br><br>

                                                                <h4 class="mb-0">Operating System:</h4><p class="mb-0">{{ get_osinfo.os }}</p><br>
                                                                <h4 class="mb-0">Kernel Version:</h4><p class="mb-0">{{ get_osinfo.kernel }}</p><br>
                                                                <h4 class="mb-0">Hostname:</h4><p class="mb-0">{{ get_osinfo.hostname }}</p><br>
                                                            </section>
                                                        </div>
                                                        {% endif %}
                                                        <!--                 -->
                                                        <!-- get_osinfo: END -->
                                                        <!--                 -->
                                                    </div>
                                                </div>
                                                <div class="row">
                                                    <div class="col-md">
                                                        <!--                     -->
                                                        <!--  get_display: START -->
                                                        <!--                     -->
                                                        {% if 'get_display' in dct['os_lst'] and dct['os_lst']['get_display']['contents'] %}
                                                            {% set temp_dct = dct['os_lst']['get_display'] %}
                                                        <div class="container border shadow-3" id="get_display">
                                                            <h2 class="mb-0 text-center">{{ temp_dct['title'] }}</h2>
                                                            <h5>HDMI</h5>
                                                            <!-- Modal here -->
                                                            <button type="button" class="btn btn-primary waves-effect waves-light" data-mdb-toggle="modal" data-mdb-target="#DisplayModal" style="float: right">
                                                                View Raw
                                                            </button><br>
                                                            <div class="modal fade" id="DisplayModal" tabindex="-1" role="dialog" aria-labelledby="DisplayModalLabel">
                                                                <div class="modal-dialog modal-xl" role="document">
                                                                    <div class="modal-content">
                                                                        <div class="modal-header">
                                                                            <h5 class="modal-title" id="DisplayModalLabel">{{ temp_dct['title'] }} (Raw)</h5>
                                                                            <button type="button" class="btn-close" data-mdb-dismiss="modal" aria-label="Close"></button>
                                                                        </div>
                                                                        <div class="modal-body">
                                                                            <div class="code-toolbar">
                                                              <pre class="grey lighten-3 mb-0 line-numbers language-bash"><code>{% for key in temp_dct['contents'] %}{{ "- " + key + " -\n" }}{% for line in temp_dct['contents'][key] %}{{ line + "\n" }}{% endfor %}{% endfor %}</code>
                                                              </pre>
                                                                            </div>
                                                                        </div>
                                                                        <div class="modal-footer">
                                                                            <button type="button" class="btn btn-secondary" data-mdb-dismiss="modal">Close</button>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <!-- Modal closed -->
                                                            <br><br>
                                                            <ul class="nav nav-tabs" id="osRelated-myTab3" role="tablist">
                                                                {% set temp = namespace(counter=0) %}
                                                                {% if temp_dct['contents'] %}
                                                                    {% for key in temp_dct['contents'] %}
                                                                        {% if temp.counter == 0 %}
                                                                <li class="nav-item active" role="presentation">
                                                                    <a
                                                                            class="nav-link active"
                                                                            aria-selected="true"
                                                                        {% else %}
                                                                <li class="nav-item" role="presentation">
                                                                    <a
                                                                            class="nav-link"
                                                                            aria-selected="false"
                                                                        {% endif %}
                                                                            id="get_display_{{ temp.counter }}-tab"
                                                                            data-mdb-toggle="tab"
                                                                            href="#get_display_{{ temp.counter }}"
                                                                            role="tab"
                                                                            aria-controls="get_display_{{ temp.counter }}"
                                                                    >{{ key }}</a
                                                                    >
                                                                </li>
                                                                    {% set temp.counter = temp.counter + 1 %}
                                                                    {% endfor %}
                                                                {% endif %}
                                                            </ul>


                                                            <div class="tab-content">
                                                                {% if temp_dct['contents'] %}
                                                                    {% set temp = namespace(counter=0) %}
                                                                    {% for key in temp_dct['contents'] %}
                                                                        {% if temp.counter == 0 %}
                                                                <div class="tab-pane active" role="tabpanel" aria-labelledby="get_display_{{ temp.counter }}-tab" id="get_display_{{ temp.counter }}">
                                                                        {% else %}
                                                                <div class="tab-pane fade" role="tabpanel" aria-labelledby="get_display_{{ temp.counter }}-tab" id="get_display_{{ temp.counter }}">
                                                                        {% endif %}
                                                                    <table class="table table-hover">
                                                                        <thead class="table-light">
                                                                            <tr>
                                                                                <th scope="col">Display</th>
                                                                                <th scope="col">Status</th>
                                                                                <th scope="col">Resolution</th>
                                                                                <th scope="col">Size</th>
                                                                            </tr>
                                                                        </thead>
                                                                        <tbody>
                                                                            {% for line in temp_dct['contents'][key] %}
                                                                                {% if line != 'No detected displays' %}
                                                                                    {% set temp_lst = line.split('(') %}
                                                                                    {% set temp_lst2 = temp_lst[0].split() %}
                                                                            <tr>
                                                                                <td>{{ temp_lst2[0] }} {% if 'primary' in temp_lst2 %}(primary){% endif %}</td>
                                                                                {% if temp_lst2[1] == 'connected' %}
                                                                                <th>{{ temp_lst2[1] }}</th>
                                                                                <td>{% if temp_lst2 | length > 2 %}{{ temp_lst2[3][:-4] }}{% endif %}</td>
                                                                                <td>{% if temp_lst2 | length > 2 %}{{ temp_lst[1].split(') ')[-1] }}{% endif %}</td>
                                                                                {% else %}
                                                                                <td>{{ temp_lst2[1] }}</td>
                                                                                <td></td>
                                                                                <td></td>
                                                                                {% endif %}
                                                                            </tr>
                                                                                {% else %}
                                                                            <tr>
                                                                                <td colspan="4">{{ line }}</td>
                                                                            </tr>
                                                                                {% endif %}
                                                                            {% endfor %}
                                                                        </tbody>
                                                                    </table>
                                                                        {% set temp.counter = temp.counter + 1 %}
                                                                </div>
                                                                    {% endfor %}
                                                                {% endif %}
                                                            </div>
                                                        </div>
                                                        {% endif %}
                                                        <!--                   -->
                                                        <!--  get_display: END -->
                                                        <!--                   -->
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="col-7 d-flex justify-content-center">
                                                <!--                       -->
                                                <!-- get_languages: START  -->
                                                <!--                       -->
                                                {% if 'get_languages' in dct['os_lst'] and dct['os_lst']['get_languages']['contents'] %}
                                                    {% set temp_dct = dct['os_lst']['get_languages'] %}
                                                <div class="container border shadow-3" id="get_languages">
                                                    <section>
                                                        <h2 class="mb-0 text-center">{{ temp_dct['title'] }}</h2>
                                                        <!-- Modal here -->
                                                        <button type="button" class="btn btn-primary waves-effect waves-light" data-mdb-toggle="modal" data-mdb-target="#DevToolsModal" style="float: right">
                                                            View Raw
                                                        </button>
                                                        <div class="modal fade" id="DevToolsModal" tabindex="-1" role="dialog" aria-labelledby="DevToolsModalLabel">
                                                            <div class="modal-dialog modal-xl" role="document">
                                                                <div class="modal-content">
                                                                    <div class="modal-header">
                                                                        <h5 class="modal-title" id="DevToolsModalLabel">Development Tools (Raw)</h5>
                                                                        <button type="button" class="btn-close" data-mdb-dismiss="modal" aria-label="Close"></button>
                                                                    </div>
                                                                    <div class="modal-body">
                                                                        <div class="code-toolbar">
                                                                            <pre class="language-bash line-numbers"><code>{% for key in temp_dct['contents'] %}{{ "- " + key + " -\n" }}{% for line in temp_dct['contents'][key] %}{{ line + "\n" }}{% endfor %}{% endfor %}</code>
                                                                            </pre>
                                                                        </div>
                                                                    </div>
                                                                    <div class="modal-footer">
                                                                        <button type="button" class="btn btn-secondary" data-mdb-dismiss="modal">Close</button>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <!-- Modal closed -->
                                                        <table class="table table-hover">
                                                            <thead class="table-light">
                                                            <tr>
                                                                <th scope="col">Language</th>
                                                                <th scope="col">Path</th>
                                                            </tr>
                                                            </thead>
                                                            <tbody>
                                                            {% for row in (temp_dct['contents'].values() | list)[0] %}
                                                            <tr>
                                                                <td>{{ row.split('/')[-1] }}</td>
                                                                <td>{{ row }}</td>
                                                            </tr>
                                                            {% endfor %}
                                                            </tbody>
                                                        </table>
                                                    </section>
                                                </div>
                                                {% endif %}
                                                <!--                      -->
                                                <!--  get_languages: END  -->
                                                <!--                      -->
                                            </div>
                                        </div>
                                        <div class="row">
                                            <div class="col d-flex justify-content-center">
                                                <!--                          -->
                                                <!--  get_networkinfo: START  -->
                                                <!--                          -->
                                                {% if 'get_networkinfo' in dct['os_lst'] and dct['os_lst']['get_networkinfo']['contents'] %}
                                                    {% set temp_dct = namespace() %}

                                                    {# 'All Network Interfaces' block #}
                                                    {% if 'All Network Interfaces' in dct['os_lst']['get_networkinfo']['contents'] %}
                                                        {% set temp_dct.all_network_interfaces = {} %}
                                                        {% for line in dct['os_lst']['get_networkinfo']['contents']['All Network Interfaces'] %}
                                                            {% if line.lstrip() == line %}
                                                                {% set split_string = line.split(': ') %}
                                                                {% set x=temp_dct.all_network_interfaces.__setitem__(split_string[0], {'interface': split_string[1], 'args': split_string[2], 'lines': {}}) %}
                                                            {% else %}
                                                                {% if temp_dct.all_network_interfaces %}
                                                                    {% set target_key = (temp_dct.all_network_interfaces.keys() | list)[-1] %}
                                                                    {% set target_dct = temp_dct.all_network_interfaces[target_key]['lines'] %}
                                                                    {% if 'link/' in line or 'inet' in line %}
                                                                        {% set x=target_dct.__setitem__(line.lstrip(), []) %}
                                                                    {% else %}
                                                                        {% set get_last_key = (target_dct.keys() | list)[-1] %}
                                                                        {% set its_array = target_dct[get_last_key] + [line.lstrip()] %}
                                                                        {% set x=target_dct.__setitem__(get_last_key, its_array) %}
                                                                    {% endif %}
                                                                    {% set x=temp_dct.all_network_interfaces[target_key].__setitem__('lines', target_dct) %}
                                                                {% endif %}
                                                            {% endif %}
                                                        {% endfor %}
                                                    {% endif %}

                                                    {# 'Network Routing Table' block #}
                                                    {% if 'Network Routing Table' in dct['os_lst']['get_networkinfo']['contents'] %}
                                                        {% set temp_dct.network_routing_table = {'title': dct['os_lst']['get_networkinfo']['contents']['Network Routing Table'][0], 'columns_as_string': '||'.join(dct['os_lst']['get_networkinfo']['contents']['Network Routing Table'][1].split()), 'lines': []} %}
                                                        {% for line in dct['os_lst']['get_networkinfo']['contents']['Network Routing Table'][2:] %}
                                                            {% set x=temp_dct.network_routing_table.__setitem__('lines', temp_dct.network_routing_table['lines'] + ['||'.join(line.split())]) %}
                                                        {% endfor %}
                                                    {% endif %}

                                                    {# 'Open ports' block #}
                                                    {% if 'Open ports' in dct['os_lst']['get_networkinfo']['contents'] %}
                                                        {% set temp_dct.open_ports = {'lines': []} %}
                                                        {% for line in dct['os_lst']['get_networkinfo']['contents']['Open ports'] %}
                                                            {% set x=temp_dct.open_ports.__setitem__('lines', temp_dct.open_ports['lines'] + ['||'.join(line.split()[:6]) + '||' + ' '.join(line.split()[6:])]) %}
                                                        {% endfor %}
                                                    {% endif %}
                                                <div class="container border shadow-3" id="get_networkinfo">
                                                    <section>
                                                        <h2 class="mb-0 text-center">Networking</h2>
                                                        <br>
                                                        <ul class="nav nav-tabs" id="osRelated-myTab" role="tablist">
                                                            <li class="nav-item active" role="presentation">
                                                                <a
                                                                        class="nav-link active"
                                                                        id="get_networkinfo_0-tab"
                                                                        data-mdb-toggle="tab"
                                                                        href="#get_networkinfo_0"
                                                                        role="tab"
                                                                        aria-controls="get_networkinfo_0"
                                                                        aria-selected="true"
                                                                >All Network Interfaces</a
                                                                >
                                                            </li>
                                                            <li class="nav-item" role="presentation">
                                                                <a
                                                                        class="nav-link"
                                                                        id="get_networkinfo_1-tab"
                                                                        data-mdb-toggle="tab"
                                                                        href="#get_networkinfo_1"
                                                                        role="tab"
                                                                        aria-controls="get_networkinfo_1"
                                                                        aria-selected="false"
                                                                >Network Routing Table</a
                                                                >
                                                            </li>
                                                            <li class="nav-item" role="presentation">
                                                                <a
                                                                        class="nav-link"
                                                                        id="Open-Ports-tab"
                                                                        data-mdb-toggle="tab"
                                                                        href="#get_networkinfo_2"
                                                                        role="tab"
                                                                        aria-controls="get_networkinfo_2"
                                                                        aria-selected="false"
                                                                >Open Ports</a
                                                                >
                                                            </li>
                                                        </ul>

                                                        <section class="border p-4 text-center mb-4">
                                                            <div class="tab-content">
                                                                {% if temp_dct.all_network_interfaces %}
                                                                <div class="tab-pane active" role="tabpanel" aria-labelledby="get_networkinfo_0-tab" id="get_networkinfo_0">
                                                                    <h4>All Network Interfaces:</h4>
                                                                    <!-- Modal here -->
                                                                    <button type="button" class="btn btn-primary waves-effect waves-light" data-mdb-toggle="modal" data-mdb-target="#get_networkinfo_0Modal" style="float: right">
                                                                        View Raw
                                                                    </button>
                                                                    <div class="modal fade" id="get_networkinfo_0Modal" tabindex="-1" role="dialog" aria-labelledby="get_networkinfo_0ModalLabel">
                                                                        <div class="modal-dialog modal-xl" role="document">
                                                                            <div class="modal-content">
                                                                                <div class="modal-header">
                                                                                    <h5 class="modal-title" id="get_networkinfo_0ModalLabel">Networking (Raw)</h5>
                                                                                    <button type="button" class="btn-close" data-mdb-dismiss="modal" aria-label="Close"></button>
                                                                                </div>
                                                                                <div class="modal-body">
                                                                                    <div class="code-toolbar">
                                                                                        <pre class="language-bash line-numbers"><code>{% if 'All Network Interfaces' in dct['os_lst']['get_networkinfo']['contents'] %}{{ "- All Network Interfaces -\n" }}{% for line in dct['os_lst']['get_networkinfo']['contents']['All Network Interfaces'] %}{{ line + "\n" }}{% endfor %}{% endif %}</code>
                                                                                        </pre>
                                                                                    </div>
                                                                                </div>
                                                                                <div class="modal-footer">
                                                                                    <button type="button" class="btn btn-secondary" data-mdb-dismiss="modal">Close</button>
                                                                                </div>
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                    <!-- Modal closed -->
                                                                    <table class="table table-hover">
                                                                        <thead class="table-light">
                                                                        <tr>
                                                                            <th scope="col">#</th>
                                                                            <th scope="col" colspan="2">Interface</th>
                                                                        </tr>
                                                                        </thead>
                                                                        <tbody>
                                                                        {% set maxlength=namespace(l=0) %}
                                                                        {% for key in temp_dct.all_network_interfaces %}
                                                                            {% for another_key in temp_dct.all_network_interfaces[key]['lines'] %}
                                                                                {% if temp_dct.all_network_interfaces[key]['lines'][another_key]|length > maxlength.l %}
                                                                                    {% set maxlength.l = temp_dct.all_network_interfaces[key]['lines'][another_key]|length %}
                                                                                {% endif %}
                                                                            {% endfor %}
                                                                        {% endfor %}
                                                                        {% for entry in temp_dct.all_network_interfaces %}
                                                                        <tr>
                                                                            <th scope="row" rowspan="{{ temp_dct.all_network_interfaces[entry]['lines'].keys() | length + (temp_dct.all_network_interfaces[entry]['lines'] | length)*maxlength.l + 1 }}">{{ entry }}</th>
                                                                            <td><mark>{{ temp_dct.all_network_interfaces[entry]['interface'] }}:</mark>{{ temp_dct.all_network_interfaces[entry]['args'] }}</td>
                                                                            {% for number in range(maxlength.l) %}
                                                                                <td></td>
                                                                            {% endfor %}
                                                                        </tr>
                                                                            {% for line in temp_dct.all_network_interfaces[entry]['lines'] %}
                                                                        <tr>
                                                                            <td scope="row" rowspan="{{ maxlength.l + 1 }}"><mark>{{ line }}</mark></td>
                                                                        </tr>
                                                                                {% for line_content in temp_dct.all_network_interfaces[entry]['lines'][line] %}
                                                                        <tr>
                                                                            <td>{{ line_content }}</td>
                                                                        </tr>
                                                                                {% endfor %}
                                                                                {% for number in range(maxlength.l - temp_dct.all_network_interfaces[entry]['lines'][line]|length) %}
                                                                        <tr>
                                                                            <td></td>
                                                                        </tr>
                                                                                {% endfor %}
                                                                            {% endfor %}
                                                                        {% endfor %}
                                                                    </table>
                                                                </div>
                                                                {% endif %}
                                                                {% if temp_dct.network_routing_table %}
                                                                <div class="tab-pane fade" role="tabpanel" aria-labelledby="get_networkinfo_1-tab" id="get_networkinfo_1">
                                                                    <h4>Network Routing Table</h4>
                                                                    <p>Kernel IP routing table</p>
                                                                    <!-- Modal here -->
                                                                    <button type="button" class="btn btn-primary waves-effect waves-light" data-mdb-toggle="modal" data-mdb-target="#get_networkinfo_1Modal" style="float: right">
                                                                        View Raw
                                                                    </button>
                                                                    <div class="modal fade" id="get_networkinfo_1Modal" tabindex="-1" role="dialog" aria-labelledby="get_networkinfo_1ModalLabel">
                                                                        <div class="modal-dialog modal-xl" role="document">
                                                                            <div class="modal-content">
                                                                                <div class="modal-header">
                                                                                    <h5 class="modal-title" id="get_networkinfo_1ModalLabel">Network Routing Table (Raw)</h5>
                                                                                    <button type="button" class="btn-close" data-mdb-dismiss="modal" aria-label="Close"></button>
                                                                                </div>
                                                                                <div class="modal-body">
                                                                                    <div class="code-toolbar">
                                                                                        <pre class="language-bash line-numbers"><code>{% if 'Network Routing Table' in dct['os_lst']['get_networkinfo']['contents'] %}{{ "- Network Routing Table -\n" }}{% for line in dct['os_lst']['get_networkinfo']['contents']['Network Routing Table'] %}{{ line + "\n" }}{% endfor %}{% endif %}</code>
                                                                                        </pre>
                                                                                    </div>
                                                                                </div>
                                                                                <div class="modal-footer">
                                                                                    <button type="button" class="btn btn-secondary" data-mdb-dismiss="modal">Close</button>
                                                                                </div>
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                    <!-- Modal closed -->
                                                                    <table class="table table-hover">
                                                                        <thead class="table-light">
                                                                        <tr>
                                                                            {% for column_name in temp_dct.network_routing_table['columns_as_string'].split('||') %}
                                                                            <th scope="row">{{ column_name }}</th>
                                                                            {% endfor %}
                                                                        </tr>
                                                                        </thead>
                                                                        <tbody>
                                                                            {% for row in temp_dct.network_routing_table['lines'] %}
                                                                            <tr>
                                                                                {% for row_data in row.split('||') %}
                                                                                <td>{{ row_data }}</td>
                                                                                {% endfor %}
                                                                            </tr>
                                                                            {% endfor %}
                                                                        </tbody>
                                                                    </table>
                                                                </div>
                                                                {% endif %}
                                                                {% if temp_dct.open_ports %}
                                                                <div class="tab-pane fade" role="tabpanel" aria-labelledby="get_networkinfo_2-tab" id="get_networkinfo_2">
                                                                    <h4>Open ports</h4>
                                                                    <!-- Modal here -->
                                                                    <button type="button" class="btn btn-primary waves-effect waves-light" data-mdb-toggle="modal" data-mdb-target="#get_networkinfo_2Modal" style="float: right">
                                                                        View Raw
                                                                    </button>
                                                                    <div class="modal fade" id="get_networkinfo_2Modal" tabindex="-1" role="dialog" aria-labelledby="get_networkinfo_2ModalLabel">
                                                                        <div class="modal-dialog modal-xl" role="document">
                                                                            <div class="modal-content">
                                                                                <div class="modal-header">
                                                                                    <h5 class="modal-title" id="get_networkinfo_2ModalLabel">Open Ports (Raw)</h5>
                                                                                    <button type="button" class="btn-close" data-mdb-dismiss="modal" aria-label="Close"></button>
                                                                                </div>
                                                                                <div class="modal-body">
                                                                                    <div class="code-toolbar">
                                                                                        <pre class="language-bash line-numbers"><code>{% if 'Network Routing Table' in dct['os_lst']['get_networkinfo']['contents'] %}{{ "- Network Routing Table -\n" }}{% for line in dct['os_lst']['get_networkinfo']['contents']['Network Routing Table'] %}{{ line + "\n" }}{% endfor %}{% endif %}</code>
                                                                                        </pre>
                                                                                    </div>
                                                                                </div>
                                                                                <div class="modal-footer">
                                                                                    <button type="button" class="btn btn-secondary" data-mdb-dismiss="modal">Close</button>
                                                                                </div>
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                    <!-- Modal closed -->
                                                                    <table class="table table-hover">
                                                                        <thead>
                                                                        <tr>
                                                                            <td>Proto</td>
                                                                            <td>Recv-Q</td>
                                                                            <td>Send-Q</td>
                                                                            <td>Local Address</td>
                                                                            <td>Foreign Address</td>
                                                                            <td>State</td>
                                                                            <td>PID/Program name</td>
                                                                        </tr>
                                                                        </thead>
                                                                        <tbody>
                                                                        {% for row in temp_dct.open_ports['lines'][2:] %}
                                                                        <tr>
                                                                            {% for row_data in row.split('||') %}
                                                                            <td>{{ row_data }}</td>
                                                                            {% endfor %}
                                                                        </tr>
                                                                        {% endfor %}
                                                                        </tbody>
                                                                    </table>
                                                                </div>
                                                                {% endif %}
                                                            </div>
                                                        </section>
                                                    </section>
                                                </div>
                                                {% endif %}
                                                <!--                      -->
                                                <!-- get_networkinfo: END -->
                                                <!--                      -->
                                            </div>
                                        </div>
                                        <div class="row">
                                            <div class="col d-flex justify-content-center">
                                                <!--                        -->
                                                <!--  get_filesystem: START -->
                                                <!--                        -->
                                                {% if 'get_filesystem' in dct['os_lst'] and dct['os_lst']['get_filesystem']['contents'] %}
                                                    {% set temp_dct = dct['os_lst']['get_filesystem'] %}
                                                <div class="container border shadow-3" id="get_filesystem">
                                                    <section>
                                                        <h2 class="mb-0 text-center">{{ temp_dct['title'] }}</h2>
                                                        <br>
                                                        <ul class="nav nav-tabs" id="osRelated-myTab1" role="tablist">
                                                            <li class="nav-item active" role="presentation">
                                                                <a
                                                                        class="nav-link active"
                                                                        id="Fstab-tab"
                                                                        data-mdb-toggle="tab"
                                                                        href="#get_filesystem_0"
                                                                        role="tab"
                                                                        aria-controls="get_filesystem_0"
                                                                        aria-selected="true"
                                                                >Filesystem Table (/etc/fstab)</a
                                                                >
                                                            </li>
                                                            <li class="nav-item" role="presentation">
                                                                <a
                                                                        class="nav-link"
                                                                        id="Mounts-tab"
                                                                        data-mdb-toggle="tab"
                                                                        href="#get_filesystem_1"
                                                                        role="tab"
                                                                        aria-controls="get_filesystem_1"
                                                                        aria-selected="false"
                                                                >Mounts</a
                                                                >
                                                            </li>
                                                        </ul>

                                                        <section class="border p-4 text-center mb-4">
                                                            <div class="tab-content">
                                                                <div class="tab-pane container active" role="tabpanel" aria-labelledby="Fstab-tab" id="get_filesystem_0">
                                                                    <h5>Filesystem Table (/etc/fstab)</h5>
                                                                    <!-- Modal here -->
                                                                    <button type="button" class="btn btn-primary waves-effect waves-light" data-mdb-toggle="modal" data-mdb-target="#FstabModal" style="float: right">
                                                                        View Raw
                                                                    </button>
                                                                    <div class="modal fade" id="FstabModal" tabindex="-1" role="dialog" aria-labelledby="FstabModalLabel">
                                                                        <div class="modal-dialog modal-xl" role="document">
                                                                            <div class="modal-content">
                                                                                <div class="modal-header">
                                                                                    <h5 class="modal-title" id="FstabModalLabel">Fstab (Raw)</h5>
                                                                                    <button type="button" class="btn-close" data-mdb-dismiss="modal" aria-label="Close"></button>
                                                                                </div>
                                                                                <div class="modal-body">
                                                                                    <div class="code-toolbar">
                                                                                        <pre class="language-bash line-numbers"><code>{% if 'Filesystem Table (/etc/fstab)' in dct['os_lst']['get_filesystem']['contents'] %}{{ "- Filesystem Table (/etc/fstab) -\n" }}{% for line in dct['os_lst']['get_filesystem']['contents']['Filesystem Table (/etc/fstab)'] %}{{ line + "\n" }}{% endfor %}{% endif %}</code>
                                                                                        </pre>
                                                                                    </div>
                                                                                </div>
                                                                                <div class="modal-footer">
                                                                                    <button type="button" class="btn btn-secondary" data-mdb-dismiss="modal">Close</button>
                                                                                </div>
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                    <!-- Modal closed -->
                                                                    <table class="table table-hover">
                                                                        <thead class="table-light">
                                                                            <tr>
                                                                                <th scope="row">File System</th>
                                                                                <th scope="row">Mount Point</th>
                                                                                <th scope="row">Type</th>
                                                                                <th scope="row">Options</th>
                                                                                <th scope="row">Dump</th>
                                                                                <th scope="row">Pass</th>
                                                                            </tr>
                                                                        </thead>
                                                                        <tbody>
                                                                        {% for row in temp_dct['contents']['Filesystem Table (/etc/fstab)'] %}
                                                                            {% if row.lstrip()[0] != '#' %}
                                                                        <tr>
                                                                                {% for row_data in row.split() %}
                                                                            <td>{{ row_data }}</td>
                                                                                {% endfor %}
                                                                        </tr>
                                                                            {% endif %}
                                                                        {% endfor %}
                                                                        </tbody>
                                                                    </table>
                                                                </div>
                                                                <div class="tab-pane fade" role="tabpanel" aria-labelledby="Mounts-tab" id="get_filesystem_1">
                                                                    <h5>Mounts</h5>
                                                                    <h5 {% if temp_dct['contents']['Mounts:'][-1][:3] == '(!)' %} style="color:red" {% endif %}>{{ temp_dct['contents']['Mounts:'][-1] }}</h5>
                                                                    <!-- Modal here -->
                                                                    <button type="button" class="btn btn-primary waves-effect waves-light" data-mdb-toggle="modal" data-mdb-target="#MountsModal" style="float: right">
                                                                        View Raw
                                                                    </button>
                                                                    <div class="modal fade" id="MountsModal" tabindex="-1" role="dialog" aria-labelledby="MountsModalLabel">
                                                                        <div class="modal-dialog modal-xl" role="document">
                                                                            <div class="modal-content">
                                                                                <div class="modal-header">
                                                                                    <h5 class="modal-title" id="MountsModalLabel">Mounts (Raw)</h5>
                                                                                    <button type="button" class="btn-close" data-mdb-dismiss="modal" aria-label="Close"></button>
                                                                                </div>
                                                                                <div class="modal-body">
                                                                                    <div class="code-toolbar">
                                                                                        <pre class="language-bash line-numbers"><code>{% if 'Mounts:' in dct['os_lst']['get_filesystem']['contents'] %}{{ "- Mounts: -\n" }}{% for line in dct['os_lst']['get_filesystem']['contents']['Mounts:'] %}{{ line + "\n" }}{% endfor %}{% endif %}</code>
                                                                                        </pre>
                                                                                    </div>
                                                                                </div>
                                                                                <div class="modal-footer">
                                                                                    <button type="button" class="btn btn-secondary" data-mdb-dismiss="modal">Close</button>
                                                                                </div>
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                    <!-- Modal closed -->
                                                                    <table class="table table-hover">
                                                                        <thead class="table-light">
                                                                        <tr>
                                                                            <th scope="row">fs_spec</th>
                                                                            <th scope="row">fs_file</th>
                                                                            <th scope="row">fs_vfstype</th>
                                                                            <th scope="row">fs_mntopts</th>
                                                                        </tr>
                                                                        </thead>
                                                                        <tbody>
                                                                        {% for row in temp_dct['contents']['Mounts:'][:-1] %}
                                                                            {% if row.lstrip()[0] != '#' %}
                                                                                {% set temp_row = row.split() %}
                                                                        <tr>
                                                                            <td>{{ temp_row[0] }}</td>
                                                                            <td>{{ temp_row[2] }}</td>
                                                                            <td>{{ temp_row[4] }}</td>
                                                                            <td>{{ ' '.join(temp_row[5:]) }}</td>
                                                                        </tr>
                                                                            {% endif %}
                                                                        {% endfor %}
                                                                        </tbody>
                                                                    </table>
                                                                </div>
                                                            </div>
                                                        </section>
                                                    </section>
                                                </div>
                                                {% endif %}
                                                <!--                       -->
                                                <!--  get_filesystem: END  -->
                                                <!--                       -->
                                            </div>
                                        </div>
                                        <div class="row">
                                            <div class="col d-flex justify-content-center">
                                                <!--                  -->
                                                <!--  get_cron: START -->
                                                <!--                  -->
                                                {% if 'get_cron' in dct['os_lst'] and dct['os_lst']['get_cron']['contents'] %}
                                                    {% set temp_dct = dct['os_lst']['get_cron'] %}
                                                <div class="container border shadow-3" id="get_cron">
                                                    <section>
                                                        <h2 class="mb-0 text-center">Cron Tasks</h2>
                                                        <br>
                                                        <ul class="nav nav-tabs" id="osRelated-myTab2" role="tablist">
                                                            <li class="nav-item active" role="presentation">
                                                                <a
                                                                        class="nav-link active"
                                                                        id="Scheduled-cron-tab"
                                                                        data-mdb-toggle="tab"
                                                                        href="#get_cron_0"
                                                                        role="tab"
                                                                        aria-controls="get_cron_0"
                                                                        aria-selected="true"
                                                                >Scheduled</a>
                                                            </li>
                                                            <li class="nav-item" role="presentation">
                                                                <a
                                                                        class="nav-link"
                                                                        id="Writeable-cron-directories-tab"
                                                                        data-mdb-toggle="tab"
                                                                        href="#get_cron_1"
                                                                        role="tab"
                                                                        aria-controls="get_cron_1"
                                                                        aria-selected="false"
                                                                >Writeable cron directories</a>
                                                            </li>
                                                            <li class="nav-item" role="presentation">
                                                                <a
                                                                        class="nav-link"
                                                                        id="Users-cron-tab"
                                                                        data-mdb-toggle="tab"
                                                                        href="#get_cron_2"
                                                                        role="tab"
                                                                        aria-controls="get_cron_2"
                                                                        aria-selected="false"
                                                                >Users' cron jobs</a>
                                                            </li>
                                                        </ul>

                                                        <section class="border p-4 text-center mb-4">
                                                            <div class="tab-content">
                                                                <div class="tab-pane container active" role="tabpanel" aria-labelledby="Scheduled-cron-tab" id="get_cron_0">
                                                                    <h5>Scheduled Cron Jobs</h5>
                                                                    <div class="code-toolbar">
                                                                        <pre class="language-bash line-numbers"><code>{% if 'Scheduled cron jobs' in dct['os_lst']['get_cron']['contents'] %}{{ "- Scheduled cron jobs -\n" }}{% for line in dct['os_lst']['get_cron']['contents']['Scheduled cron jobs'] %}{{ line + "\n" }}{% endfor %}{% endif %}</code>
                                                                        </pre>
                                                                    </div>
                                                                </div>
                                                                <div class="tab-pane fade" role="tabpanel" aria-labelledby="Writeable-cron-directories-tab" id="get_cron_1">
                                                                    <h5>Writeable Cron Directories</h5>
                                                                    <div class="code-toolbar">
                                                                        <pre class="language-bash line-numbers"><code>{% if 'Writeable cron directories' in dct['os_lst']['get_cron']['contents'] %}{{ "- Writeable cron directories -\n" }}{% for line in dct['os_lst']['get_cron']['contents']['Writeable cron directories'] %}{{ line + "\n" }}{% endfor %}{% endif %}</code>
                                                                        </pre>
                                                                    </div>
                                                                </div>
                                                                <div class="tab-pane fade" role="tabpanel" aria-labelledby="Users-cron-tab" id="get_cron_2">
                                                                    <h5>Users' Cron Jobs</h5>
                                                                    <div class="code-toolbar">
                                                                        <pre class="language-bash line-numbers"><code>{% if "Users' cron jobs" in dct['os_lst']['get_cron']['contents'] %}{{ "- Users' cron jobs -\n" }}{% for line in dct['os_lst']['get_cron']['contents']["Users' cron jobs"] %}{{ line + "\n" }}{% endfor %}{% endif %}</code>
                                                                        </pre>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </section>
                                                    </section>
                                                </div>
                                                {% endif %}
                                                <!--                 -->
                                                <!--  get_cron: END  -->
                                                <!--                 -->
                                            </div>
                                        </div>
                                        <div class="row">
                                            <div class="col d-flex justify-content-center">
                                                <!--                    -->
                                                <!--  get_envvar: START -->
                                                <!--                    -->
                                                {% if 'get_envvar' in dct['os_lst'] and dct['os_lst']['get_envvar']['contents'] %}
                                                    {% set temp_dct = dct['os_lst']['get_envvar'] %}
                                                <div class="container border shadow-3" id="get_envvar">
                                                    <h2 class="mb-0 text-center">{{ temp_dct['title'] }}</h2>
                                                    <br>
                                                    <h5>View all environment variables</h5>
                                                    <div class="code-toolbar">
                                                        <pre class="language-bash line-numbers"><code>{% for key in temp_dct['contents'] %}{{ "- " + key + " -\n" }}{% for line in temp_dct['contents'][key] %}{{ line + "\n" }}{% endfor %}{% endfor %}</code>
                                                        </pre>
                                                    </div>
                                                </div>
                                                {% endif %}
                                                <!--                   -->
                                                <!--  get_envvar: END  -->
                                                <!--                   -->
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        {% endif %}




        {% if 'ur_lst' in dct %}
            {% if temp_count.counter == 0 %}
        <div class="tab-pane show active" id="ur_lst" role="tabpanel" aria-labelledby="ur_lst-tab">
                {% set temp_count.counter = 1 %}
            {% else %}
        <div class="tab-pane fade" id="ur_lst" role="tabpanel" aria-labelledby="ur_lst-tab">
            {% endif %}
            <div id="wrapper">
                <div id="sidebar-wrapper">
                    <ul class="sidebar-nav">
                        <li class="list-group-item "><a href="#local_users">Local Users</a></li>
                        <li class="list-group-item"><a href="#test_userdir">Home: Permissions</a></li>
                        <li class="list-group-item"><a href="#check_directory_rootowner">Home: Non-owner files</a></li>
                        <ul class="list-group-item" style="position: fixed; bottom: 0">
                            {% for item in info_dct %}
                            <li class="list-group-item"><strong>{{ item }}</strong>: <span style='float:right'>{{ info_dct[item] }}</span></li>
                            {% endfor %}
                        </ul>
                    </ul>
                </div>
                <div id="page-content-wrapper">
                    <div class="page-content">
                        <div class="container">
                            <div class="row">
                                <div class="col-md-12">
                                    <div class="container">
                                        <div class="row">
                                            <div class="col-md">
                                                <div class="container border shadow-3" id="local_users">
                                                    <h2 class="mb-0 text-center">Local Users</h2>
                                                    <ul class="nav nav-tabs" id="userRelated-myTab" role="tablist">
                                                        <li class="nav-item active" role="presentation">
                                                            <a
                                                                    class="nav-link active"
                                                                    id="Default-Users-tab"
                                                                    data-mdb-toggle="tab"
                                                                    href="#default_users"
                                                                    role="tab"
                                                                    aria-controls="default_users"
                                                                    aria-selected="true"
                                                            >Default users</a>
                                                        </li>
                                                        <li class="nav-item" role="presentation">
                                                            <a
                                                                    class="nav-link"
                                                                    id="Valid-Users-tab"
                                                                    data-mdb-toggle="tab"
                                                                    href="#valid_users"
                                                                    role="tab"
                                                                    aria-controls="valid_users"
                                                                    aria-selected="false"
                                                            >Valid Users</a>
                                                        </li>
                                                    </ul>

                                                    <section class="border p-4 text-center mb-4">
                                                        <div class="tab-content">
                                                            <!--                           -->
                                                            <!-- check_defaultUsers: START -->
                                                            <!--                           -->
                                                            <div class="tab-pane active" role="tabpanel" aria-labelledby="Valid-Users-tab" id="default_users">
                                                                {% if 'check_defaultUsers' in dct['ur_lst'] and dct['ur_lst']['check_defaultUsers']['contents'] %}
                                                                {% set temp_dct = dct['ur_lst']['check_defaultUsers'] %}
                                                                {% set temp_key = (temp_dct['contents'].keys() | list)[0] %}
                                                                <h4>Checking if default users are locked</h4>
                                                                <!-- Modal here -->
                                                                <button type="button" class="btn btn-primary waves-effect waves-light" data-mdb-toggle="modal" data-mdb-target="#defaultUsersModal" style="float: right">
                                                                    View Raw
                                                                </button>
                                                                <div class="modal fade" id="defaultUsersModal" tabindex="-1" role="dialog" aria-labelledby="defaultUsersModalLabel">
                                                                    <div class="modal-dialog modal-xl" role="document">
                                                                        <div class="modal-content">
                                                                            <div class="modal-header">
                                                                                <h5 class="modal-title" id="defaultUsersModalLabel">Default Users (Raw)</h5>
                                                                                <button type="button" class="btn-close" data-mdb-dismiss="modal" aria-label="Close"></button>
                                                                            </div>
                                                                            <div class="modal-body">
                                                                                <div class="code-toolbar">
                                                                    <pre class="language-bash line-numbers"><code>{% for key in temp_dct['contents'] %}{{ "- " + key + " -\n" }}{% for line in temp_dct['contents'][key] %}{{ line + "\n" }}{% endfor %}{% endfor %}</code>
                                                                    </pre>
                                                                                </div>
                                                                            </div>
                                                                            <div class="modal-footer">
                                                                                <button type="button" class="btn btn-secondary" data-mdb-dismiss="modal">Close</button>
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                                <!-- Modal closed -->
                                                                {% set temp = namespace(dct={}) %}
                                                                {% for line in temp_dct['contents'][temp_key] %}
                                                                {% if '|---' not in line %}
                                                                {% set x=temp.dct.__setitem__(line, []) %}
                                                                {% else %}
                                                                {% set bruh=temp.dct[(temp.dct.keys() | list)[-1]] + [line] %}
                                                                {% set x=temp.dct.__setitem__((temp.dct.keys() | list)[-1], bruh) %}
                                                                {% endif %}
                                                                {% endfor %}
                                                                <table class="table table-hover">
                                                                    <thead class="thead-light">
                                                                    <tr>
                                                                        <th colspan="4">{{ temp_dct['title'] }}</th>
                                                                    </tr>
                                                                    </thead>
                                                                    <tbody>
                                                                    {% for key in temp.dct %}
                                                                    <tr class='list-group-item-danger'>
                                                                        <th scope="row" rowspan="{{ temp.dct[key] | length + 1}}">{{ key }}</th>
                                                                    </tr>
                                                                    {% for data in temp.dct[key] %}
                                                                    <tr class='list-group-item-danger'>
                                                                        {% for that in data.split() %}
                                                                        {% if '|---' in that %}
                                                                        {% set that = that[4:] %}
                                                                        {% endif %}
                                                                        <td>{{ that }}</td>
                                                                        {% endfor %}
                                                                        {% for number in range(3 - data.split() | length) %}
                                                                        <td></td>
                                                                        {% endfor %}
                                                                    </tr>
                                                                    {% endfor %}
                                                                    {% endfor %}
                                                                    </tbody>
                                                                </table>
                                                                {% endif %}
                                                            </div>
                                                            <!--                         -->
                                                            <!-- check_defaultUsers: END -->
                                                            <!--                         -->
                                                            <!--                        -->
                                                            <!-- return_allusers: START -->
                                                            <!--                        -->
                                                            <div class="tab-pane fade" role="tabpanel" aria-labelledby="Valid-Users-tab" id="valid_users">
                                                                {% if 'return_allusers' in dct['ur_lst'] and dct['ur_lst']['return_allusers']['contents'] %}
                                                                {% set temp_dct = dct['ur_lst']['return_allusers'] %}
                                                                <h4>Identified users with valid logins</h4>
                                                                <!-- Modal here -->
                                                                <button type="button" class="btn btn-primary waves-effect waves-light" data-mdb-toggle="modal" data-mdb-target="#validUsersModal" style="float: right">
                                                                    View Raw
                                                                </button>
                                                                <div class="modal fade" id="validUsersModal" tabindex="-1" role="dialog" aria-labelledby="validUsersModalLabel">
                                                                    <div class="modal-dialog modal-xl" role="document">
                                                                        <div class="modal-content">
                                                                            <div class="modal-header">
                                                                                <h5 class="modal-title" id="validUsersModalLabel">Valid Users (Raw)</h5>
                                                                                <button type="button" class="btn-close" data-mdb-dismiss="modal" aria-label="Close"></button>
                                                                            </div>
                                                                            <div class="modal-body">
                                                                                <div class="code-toolbar">
                                                                    <pre class="language-bash line-numbers"><code>{% for key in temp_dct['contents'] %}{{ "- " + key + " -\n" }}{% for line in temp_dct['contents'][key] %}{{ line + "\n" }}{% endfor %}{% endfor %}</code>
                                                                    </pre>
                                                                                </div>
                                                                            </div>
                                                                            <div class="modal-footer">
                                                                                <button type="button" class="btn btn-secondary" data-mdb-dismiss="modal">Close</button>
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                                <!-- Modal closed -->
                                                                {% if 'Users with valid shells' in temp_dct['contents'] %}
                                                                {% if 'Groups memberships' in temp_dct['contents'] and temp_dct['contents']['Groups memberships'] | length > 1 %}
                                                                {% set r_as=namespace(dct={}) %}
                                                                {% for i in temp_dct['contents']['Groups memberships'][1:] %}
                                                                {% set x=r_as.dct.__setitem__(i.split(' ', 1)[0], i.split(' ', 1)[1]) %}
                                                                {% endfor %}
                                                                {% endif %}
                                                                <table class="table table-hover">
                                                                    <thead class="thead-dark">
                                                                    <tr>
                                                                        {% for column_name in temp_dct['contents']['Users with valid shells'][0].split() %}
                                                                        <th scope="row">{{ column_name }}</th>
                                                                        {% endfor %}
                                                                    </tr>
                                                                    </thead>
                                                                    <tbody>
                                                                    {% for row in temp_dct['contents']['Users with valid shells'][1:] %}
                                                                    <tr>
                                                                        {% for row_data in row.split() %}
                                                                        <td>
                                                                            {% if row.split().index(row_data) == 0 and r_as.dct and r_as.dct[row.split()[0]] %}
                                                                            {% set r_as_temp = namespace(lst=[]) %}
                                                                            {% for item in r_as.dct[row.split()[0]].split() %}
                                                                            {% if item.split(':')[0] in ['sudo', 'wheel', 'shadow', 'disk', 'video', 'root','docker', 'lxc', 'lxd', 'adm', 'auth', 'admin'] %}
                                                                            {% set r_as_temp.lst = r_as_temp.lst + ["<b class='bg-warning'>%s</b>"%item] %}
                                                                            {% else %}
                                                                            {% set r_as_temp.lst = r_as_temp.lst + [item] %}
                                                                            {% endif %}
                                                                            {% endfor %}
                                                                            {% set r_as_temp = ' '.join(r_as_temp.lst) %}
                                                                            <button
                                                                                    type="button"
                                                                                    class="btn btn-secondary"
                                                                                    data-mdb-container="body"
                                                                                    data-mdb-toggle="popover"
                                                                                    data-mdb-placement="left"
                                                                                    data-mdb-content="{{ r_as_temp }}"
                                                                                    data-mdb-html = "true"
                                                                            >
                                                                                {{ row_data }}
                                                                            </button>
                                                                            {% else %}
                                                                            {{ row_data }}
                                                                            {% endif %}
                                                                        </td>
                                                                        {% endfor %}
                                                                    </tr>
                                                                    {% endfor %}
                                                                    </tbody>
                                                                </table>
                                                                {% endif %}
                                                                {% endif %}
                                                            </div>
                                                            <!--                      -->
                                                            <!-- return_allusers: END -->
                                                            <!--                      -->
                                                        </div>
                                                    </section>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="row">
                                            <div class="col-md">
                                                <!--                     -->
                                                <!-- test_userdir: START -->
                                                <!--                     -->
                                                <div class="container border shadow-3" id="test_userdir">
                                                    {% if 'test_userdir' in dct['ur_lst'] and dct['ur_lst']['test_userdir']['contents'] %}
                                                    {% set temp_dct = dct['ur_lst']['test_userdir'] %}
                                                    <h2 class="mb-0 text-center">{{ temp_dct['title'] }}</h2>
                                                    <!-- Modal here -->
                                                    <button type="button" class="btn btn-primary waves-effect waves-light" data-mdb-toggle="modal" data-mdb-target="#checkDirectoryRootOwnerModal" style="float: right">
                                                        View Raw
                                                    </button>
                                                    <div class="modal fade" id="checkDirectoryRootOwnerModal" tabindex="-1" role="dialog" aria-labelledby="defaultUsersModalLabel">
                                                        <div class="modal-dialog modal-xl" role="document">
                                                            <div class="modal-content">
                                                                <div class="modal-header">
                                                                    <h5 class="modal-title" id="checkDirectoryRootOwnerModalLabel">Checking permissions for all non-system users' directories (Raw)</h5>
                                                                    <button type="button" class="btn-close" data-mdb-dismiss="modal" aria-label="Close"></button>
                                                                </div>
                                                                <div class="modal-body">
                                                                    <div class="code-toolbar">
                                                        <pre class="language-bash line-numbers"><code>{% for key in temp_dct['contents'] %}{{ "- " + key + " -\n" }}{% for line in temp_dct['contents'][key] %}{{ line + "\n" }}{% endfor %}{% endfor %}</code>
                                                        </pre>
                                                                    </div>
                                                                </div>
                                                                <div class="modal-footer">
                                                                    <button type="button" class="btn btn-secondary" data-mdb-dismiss="modal">Close</button>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <!-- Modal closed -->
                                                    <ul class="nav nav-tabs" id="userRelated-myTab1" role="tablist">
                                                        <p style="font-weight:bold"></p>
                                                        {% set home_dir_temp = namespace(counter=0) %}
                                                        {% for home_directory in temp_dct['contents'] %}
                                                        {% if home_dir_temp.counter == 0 %}
                                                        <li class="nav-item active" role="presentation">
                                                            <a
                                                                    class="nav-link active"
                                                                    aria-selected="true"
                                                                    {% else %}
                                                        <li class="nav-item" role="presentation">
                                                            <a
                                                                    class="nav-link"
                                                                    aria-selected="false"
                                                                    {% endif %}
                                                                    id="test_userdir_{{ home_dir_temp.counter }}-tab"
                                                                    data-mdb-toggle="tab"
                                                                    href="#test_userdir_{{ home_dir_temp.counter }}"
                                                                    role="tab"
                                                                    aria-controls="test_userdir_{{ home_dir_temp.counter }}"
                                                            >{{ home_directory.split()[-1].split('/')[-1] }}</a>
                                                        </li>
                                                        {% set home_dir_temp.counter = home_dir_temp.counter + 1 %}
                                                        {% endfor %}
                                                    </ul>

                                                    <section class="border p-4 text-center mb-4">
                                                        <div class="tab-content">
                                                            {% set home_dir_temp = namespace(counter=0) %}
                                                            {% for home_directory in temp_dct['contents'] %}
                                                            {% if home_dir_temp.counter == 0 %}
                                                            <div class="tab-pane active" role="tabpanel" aria-labelledby="test_userdir_{{ home_dir_temp.counter }}-tab" id="test_userdir_{{ home_dir_temp.counter }}">
                                                                {% else %}
                                                                <div class="tab-pane fade" role="tabpanel" aria-labelledby="test_userdir_{{ home_dir_temp.counter }}-tab" id="test_userdir_{{ home_dir_temp.counter }}">
                                                                    {% endif %}
                                                                    <p style="font-weight:bold">{{ home_directory.lstrip() }}</p>
                                                                    <table class="table table-hover">
                                                                        <thead class="thead-dark">
                                                                        <tr>
                                                                            <th scope="row">{{ (temp_dct['contents'].values() | list)[0][0].split()[0] }}</th>
                                                                            <th scope="row">{{ (temp_dct['contents'].values() | list)[0][0].split()[3] }}</th>
                                                                            <th scope="row">{{ (temp_dct['contents'].values() | list)[0][0].split()[2] }}</th>
                                                                            <th scope="row">{{ (temp_dct['contents'].values() | list)[0][0].split()[1] }}</th>
                                                                        </tr>
                                                                        </thead>
                                                                        <tbody>
                                                                        {% for row in (temp_dct['contents'].values() | list)[0][1:] %}
                                                                        <tr {% if 'GOOD' in row.split()[1]|string %}class='list-group-item-success'{% elif not 'MISSING' %}class='list-group-item-danger'{% endif %}>
                                                                        <td>{{ row.split()[0] }}</td>
                                                                        <td>{{ (row.split()[3]|string)[:-3] }}<h5>{{ (row.split()[3]|string)[-3:] }}</h5></td>
                                                                        <td><h5>{{ row.split()[2] }}</h5></td>
                                                                        <td>{{ row.split()[1] }}</td>
                                                                        </tr>
                                                                        {% endfor %}
                                                                        </tbody>
                                                                    </table>
                                                                </div>
                                                                {% set home_dir_temp.counter = home_dir_temp.counter + 1 %}
                                                                {% endfor %}
                                                            </div>
                                                    </section>
                                                    {% endif %}
                                                </div>
                                                <!--                   -->
                                                <!-- test_userdir: END -->
                                                <!--                   -->
                                            </div>
                                        </div>
                                        <div class="row">
                                            <div class="col-md">
                                                <!--                                  -->
                                                <!-- check_directory_rootowner: START -->
                                                <!--                                  -->
                                                <div class="container border shadow-3" id="check_directory_rootowner">
                                                    {% if 'check_directory_rootowner' in dct['ur_lst'] and dct['ur_lst']['check_directory_rootowner']['contents'] %}
                                                    {% set temp_dct = dct['ur_lst']['check_directory_rootowner'] %}
                                                    <h2 class="mb-0 text-center">{{ temp_dct['title'] }}</h2>
                                                    <!-- Modal here -->
                                                    <button type="button" class="btn btn-primary waves-effect waves-light" data-mdb-toggle="modal" data-mdb-target="#check_directory_rootownerModal" style="float: right">
                                                        View Raw
                                                    </button>
                                                    <div class="modal fade" id="check_directory_rootownerModal" tabindex="-1" role="dialog" aria-labelledby="check_directory_rootownerModalLabel">
                                                        <div class="modal-dialog modal-xl" role="document">
                                                            <div class="modal-content">
                                                                <div class="modal-header">
                                                                    <h5 class="modal-title" id="check_directory_rootownerModalLabel">Checking permissions for all non-system users' directories (Raw)</h5>
                                                                    <button type="button" class="btn-close" data-mdb-dismiss="modal" aria-label="Close"></button>
                                                                </div>
                                                                <div class="modal-body">
                                                                    <div class="code-toolbar">
                                                        <pre class="language-bash line-numbers"><code>{% for key in temp_dct['contents'] %}{{ "- " + key + " -\n" }}{% for line in temp_dct['contents'][key] %}{{ line + "\n" }}{% endfor %}{% endfor %}</code>
                                                        </pre>
                                                                    </div>
                                                                </div>
                                                                <div class="modal-footer">
                                                                    <button type="button" class="btn btn-secondary" data-mdb-dismiss="modal">Close</button>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <!-- Modal closed -->
                                                    <ul class="nav nav-tabs" id="userRelated-myTab2" role="tablist">
                                                        <p style="font-weight:bold"></p>
                                                        {% set home_dir_temp = namespace(counter=0) %}
                                                        {% for home_directory in temp_dct['contents'] %}
                                                        {% if not temp_dct['contents'][home_directory] %}
                                                        <li class="nav-item" role="presentation">
                                                            <a
                                                                    class="nav-link"
                                                                    aria-selected="false"
                                                                    aria-disabled="true"
                                                                    style="background-color: #9192a2"
                                                                    {% elif home_dir_temp.counter == 0 %}
                                                        <li class="nav-item active" role="presentation">
                                                            <a
                                                                    class="nav-link active"
                                                                    aria-selected="true"
                                                                    {% else %}
                                                        <li class="nav-item" role="presentation">
                                                            <a
                                                                    class="nav-link"
                                                                    aria-selected="false"
                                                                    {% endif %}
                                                                    id="check_directory_rootowner_{{ home_dir_temp.counter }}-tab"
                                                                    data-mdb-toggle="tab"
                                                                    href="#check_directory_rootowner_{{ home_dir_temp.counter }}"
                                                                    role="tab"
                                                                    aria-controls="check_directory_rootowner_{{ home_dir_temp.counter }}"
                                                            >{{ home_directory.split()[-1][1:-1] }}</a>
                                                        </li>
                                                        {% set home_dir_temp.counter = home_dir_temp.counter + 1 %}
                                                        {% endfor %}
                                                    </ul>

                                                    <section class="border p-4 text-center mb-4">
                                                        <div class="tab-content">
                                                            {% set home_dir_temp = namespace(counter=0) %}
                                                            {% for home_directory in temp_dct['contents'] %}
                                                            {% if not temp_dct['contents'][home_directory] and home_dir_temp.counter == 0 %}
                                                            <div class="tab-pane active" role="tabpanel" aria-labelledby="check_directory_rootowner_{{ home_dir_temp.counter }}-tab" id="check_directory_rootowner_{{ home_dir_temp.counter }}">
                                                                {% else %}
                                                                <div class="tab-pane fade" role="tabpanel" aria-labelledby="check_directory_rootowner_{{ home_dir_temp.counter }}-tab" id="check_directory_rootowner_{{ home_dir_temp.counter }}">
                                                                    {% endif %}
                                                                    <p style="font-weight:bold">{{ home_directory.lstrip() }}</p>
                                                                    <table class="table table-hover">
                                                                        <thead class="thead-light">
                                                                        <tr>
                                                                            <th scope="row">File</th>
                                                                            <th scope="row">Owner</th>
                                                                            <th scope="row">Group Owner</th>
                                                                            <th scope="row">Permissions</th>
                                                                        </tr>
                                                                        </thead>
                                                                        <tbody>
                                                                        {% for row in temp_dct['contents'][home_directory] %}
                                                                        <tr class='list-group-item-danger'>
                                                                            <td>{{ row.split()[3] }}</td>
                                                                            <td>{{ row.split()[1] }}</td>
                                                                            <td>{{ row.split()[2] }}</td>
                                                                            <td>{{ row.split()[0] }}</td>
                                                                        </tr>
                                                                        {% endfor %}
                                                                        </tbody>
                                                                    </table>
                                                                </div>
                                                                {% set home_dir_temp.counter = home_dir_temp.counter + 1 %}
                                                                {% endfor %}
                                                            </div>
                                                    </section>
                                                    {% endif %}
                                                </div>
                                                <!--                                -->
                                                <!-- check_directory_rootowner: END -->
                                                <!--                                -->
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        {% endif %}



        {% if 'pv_lst' in dct %}
            {% if temp_count.counter == 0 %}
        <div class="tab-pane show active" id="pv_lst" role="tabpanel" aria-labelledby="pv_lst-tab">
                {% set temp_count.counter = 1 %}
            {% else %}
        <div class="tab-pane fade" id="pv_lst" role="tabpanel" aria-labelledby="pv_lst-tab">
            {% endif %}
            <div id="wrapper">
                <div id="sidebar-wrapper">
                    <ul class="sidebar-nav">
                        <li class="list-group-item "><a href="#check_privfiles">Check certain files</a></li>
                        <li class="list-group-item"><a href="#check_privileged">Check permissions</a></li>
                        <ul class="list-group-item" style="position: fixed; bottom: 0">
                            {% for item in info_dct %}
                            <li class="list-group-item"><strong>{{ item }}</strong>: <span style='float:right'>{{ info_dct[item] }}</span></li>
                            {% endfor %}
                        </ul>
                    </ul>
                </div>
                <div id="page-content-wrapper">
                    <div class="page-content">
                        <div class="container">
                            <div class="row">
                                <div class="col-md-12">
                                    <div class="container">
                                        <div class="row">
                                            <div class="col-md">
                                                <!--                          -->
                                                <!--  check_privfiles: START  -->
                                                <!--                          -->
                                                <div class="container border shadow-3" id="check_privfiles">
                                                    {% if 'check_privfiles' in dct['pv_lst'] and dct['pv_lst']['check_privfiles']['contents'] %}
                                                    {% set temp_dct = dct['pv_lst']['check_privfiles'] %}
                                                    <h2 class="mb-0 text-center">Checking sensitive system files</h2>
                                                    <!-- Modal here -->
                                                    <button type="button" class="btn btn-primary waves-effect waves-light" data-mdb-toggle="modal" data-mdb-target="#checkPrivFilesModal" style="float: right">
                                                        View Raw
                                                    </button>
                                                    <div class="modal fade" id="checkPrivFilesModal" tabindex="-1" role="dialog" aria-labelledby="checkPrivFilesModalLabel">
                                                        <div class="modal-dialog modal-xl" role="document">
                                                            <div class="modal-content">
                                                                <div class="modal-header">
                                                                    <h5 class="modal-title" id="checkPrivFilesModalLabel">Privileged Files (Raw)</h5>
                                                                    <button type="button" class="btn-close" data-mdb-dismiss="modal" aria-label="Close"></button>
                                                                </div>
                                                                <div class="modal-body">
                                                                    <div class="code-toolbar">
                                                        <pre class="language-bash line-numbers"><code>{% for key in temp_dct['contents'] %}{{ "- " + key + " -\n" }}{% for line in temp_dct['contents'][key] %}{{ line + "\n" }}{% endfor %}{% endfor %}</code>
                                                        </pre>
                                                                    </div>
                                                                </div>
                                                                <div class="modal-footer">
                                                                    <button type="button" class="btn btn-secondary" data-mdb-dismiss="modal">Close</button>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <!-- Modal closed -->
                                                    <ul class="nav nav-tabs" id="PrivilegedFS-Related-myTab" role="tablist">
                                                        {% set check_privfiles_temp = namespace(counter=0) %}
                                                        {% for file in temp_dct['contents'] %}
                                                        {% if not temp_dct['contents'][file] %}
                                                        <li class="nav-item" role="presentation">
                                                            <a
                                                                    class="nav-link"
                                                                    aria-selected="false"
                                                                    aria-disabled="true"
                                                                    style="background-color: #9192a2"
                                                                    {% elif check_privfiles_temp.counter == 0 %}
                                                        <li class="nav-item active" role="presentation">
                                                            <a
                                                                    class="nav-link active"
                                                                    aria-selected="true"
                                                                    {% else %}
                                                        <li class="nav-item" role="presentation">
                                                            <a
                                                                    class="nav-link"
                                                                    aria-selected="false"
                                                                    {% endif %}
                                                                    id="check_privfiles_{{ check_privfiles_temp.counter }}-tab"
                                                                    data-mdb-toggle="tab"
                                                                    href="#check_privfiles_{{ check_privfiles_temp.counter }}"
                                                                    role="tab"
                                                                    aria-controls="check_privfiles_{{ check_privfiles_temp.counter }}"
                                                            >{% if check_privfiles_temp.counter == 0 %}Password Hash Check{% else %}Sudoers Check{% endif %}</a>
                                                        </li>
                                                        {% set check_privfiles_temp.counter = check_privfiles_temp.counter + 1 %}
                                                        {% endfor %}
                                                    </ul>

                                                    <section class="border p-4 text-center mb-4">
                                                        <div class="tab-content">
                                                            <div class="tab-pane active" role="tabpanel" aria-labelledby="check_privfiles_0-tab" id="check_privfiles_0">
                                                                <h4>/etc/shadow entries</h4>
                                                                <table class="table">
                                                                    <thead class="thead-light">
                                                                    <tr>
                                                                        {% for column_name in (temp_dct['contents'].values() | list)[0][0].split() %}
                                                                        <th scope="row">{{ column_name }}</th>
                                                                        {% endfor %}
                                                                    </tr>
                                                                    </thead>
                                                                    <tbody>
                                                                    {% for row in (temp_dct['contents'].values() | list)[0][1:] %}
                                                                    <tr class='{% if 'Default' in row.split()[1]|string or 'LOCKED' in row.split()[1]|string %}list-group-item-success{% else %}list-group-item-danger{% endif %}'>
                                                                    {% for row_data in row.split() %}
                                                                    <td>{{ row_data }}</td>
                                                                    {% endfor %}
                                                                    {% if row.split()|length < 3 %}
                                                                    {% for number in range(3 - row.split()|length) %}
                                                                    <td></td>
                                                                    {% endfor %}
                                                                    {% endif %}
                                                                    </tr>
                                                                    {% endfor %}
                                                                    </tbody>
                                                                </table>
                                                            </div>
                                                            <div class="tab-pane fade" role="tabpanel" aria-labelledby="check_privfiles_1-tab" id="check_privfiles_1">
                                                                <h4>/etc/sudoers entries</h4>
                                                                <p>{{ temp_dct['contents']['/etc/sudoers entries'][0] }}</p>
                                                                <table class="table">
                                                                    <thead class="thead-light">
                                                                    <tr>
                                                                        {% for column_name in temp_dct['contents']['/etc/sudoers entries'][1].split() %}
                                                                        <th scope="row">{{ column_name }}</th>
                                                                        {% endfor %}
                                                                    </tr>
                                                                    </thead>
                                                                    <tbody>
                                                                    {% for row in temp_dct['contents']['/etc/sudoers entries'][2:] %}
                                                                    <tr class='list-group-item-danger'>
                                                                        <td>{{ row.split()[0] }}</td>
                                                                        <td>{{ ' '.join(row.split()[1:]) }}</td>
                                                                    </tr>
                                                                    {% endfor %}
                                                                    </tbody>
                                                                </table>
                                                            </div>
                                                        </div>
                                                    </section>
                                                    {% endif %}
                                                </div>
                                                <!--                        -->
                                                <!--  check_privfiles: END  -->
                                                <!--                        -->
                                            </div>
                                        </div>
                                        <div class="row">
                                            <div class="col-md">
                                                <!--                           -->
                                                <!--  check_privileged: START  -->
                                                <!--                           -->
                                                <div class="container border shadow-3" id='check_privileged'>
                                                    {% if 'check_privileged' in dct['pv_lst'] and dct['pv_lst']['check_privileged']['contents'] %}
                                                    {% set temp_dct = dct['pv_lst']['check_privileged'] %}
                                                    <h2 class="mb-0 text-center">{{ temp_dct['title'] }}</h2>
                                                    <!-- Modal here -->
                                                    <button type="button" class="btn btn-primary waves-effect waves-light" data-mdb-toggle="modal" data-mdb-target="#checkPrivilegedModal" style="float: right">
                                                        View Raw
                                                    </button>
                                                    <div class="modal fade" id="checkPrivilegedModal" tabindex="-1" role="dialog" aria-labelledby="checkPrivilegedModalLabel">
                                                        <div class="modal-dialog modal-xl" role="document">
                                                            <div class="modal-content">
                                                                <div class="modal-header">
                                                                    <h5 class="modal-title" id="checkPrivilegedModalLabel">Permissions on privileged files (Raw)</h5>
                                                                    <button type="button" class="btn-close" data-mdb-dismiss="modal" aria-label="Close"></button>
                                                                </div>
                                                                <div class="modal-body">
                                                                    <div class="code-toolbar">
                                                        <pre class="language-bash line-numbers"><code>{% for key in temp_dct['contents'] %}{{ "- " + key + " -\n" }}{% for line in temp_dct['contents'][key] %}{{ line + "\n" }}{% endfor %}{% endfor %}</code>
                                                        </pre>
                                                                    </div>
                                                                </div>
                                                                <div class="modal-footer">
                                                                    <button type="button" class="btn btn-secondary" data-mdb-dismiss="modal">Close</button>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <!-- Modal closed -->
                                                    <table class="table">
                                                        <thead class="thead-light">
                                                        <tr>
                                                            <th scope="row">{{ (temp_dct['contents'].values() | list)[0][0].split()[0] }}</th>
                                                            <th scope="row">{{ (temp_dct['contents'].values() | list)[0][0].split()[3] }}</th>
                                                            <th scope="row">{{ (temp_dct['contents'].values() | list)[0][0].split()[2] }}</th>
                                                            <th scope="row">{{ (temp_dct['contents'].values() | list)[0][0].split()[1] }}</th>
                                                        </tr>
                                                        </thead>
                                                        <tbody>
                                                        {% for row in (temp_dct['contents'].values() | list)[0][1:] %}
                                                        <tr class='{% if 'GOOD' in row.split()[1]|string %}list-group-item-success{% else %}list-group-item-danger{% endif %}'>
                                                        <td>{{ row.split()[0] }}</td>
                                                        <td>{{ (row.split()[3]|string)[:-3] }}<h5>{{ (row.split()[3]|string)[-3:] }}</h5></td>
                                                        <td><h5>{{ row.split()[2] }}</h5></td>
                                                        <td>{{ row.split()[1] }}</td>
                                                        </tr>
                                                        {% endfor %}
                                                        </tbody>
                                                    </table>
                                                    {% endif %}
                                                </div>
                                                <!--                         -->
                                                <!--  check_privileged: END  -->
                                                <!--                         -->
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        {% endif %}



        {% if 'xr_lst' in dct %}
            {% if temp_count.counter == 0 %}
        <div class="tab-pane show active" id="xr_lst" role="tabpanel" aria-labelledby="xr_lst-tab">
                {% set temp_count.counter = 1 %}
            {% else %}
        <div class="tab-pane fade" id="xr_lst" role="tabpanel" aria-labelledby="xr_lst-tab">
            {% endif %}
            <div id="wrapper">
                <div id="sidebar-wrapper">
                    <ul class="sidebar-nav">
                        <li class="list-group-item"><a href="#checkSetPasswords">Pwd Hash Check</a></li>
                            <li class="list-group-item"><a href="#xr_lst_1">Boot-Related</a></li>
                            <li class="list-group-item"><a href="#xr_lst_2">GUI-Related</a></li>
                            <li class="list-group-item"><a href="#xr_lst_3">Package Checker</a></li>
                        <ul class="list-group-item" style="position: fixed; bottom: 0">
                            {% for item in info_dct %}
                            <li class="list-group-item"><strong>{{ item }}</strong>: <span style='float:right'>{{ info_dct[item] }}</span></li>
                            {% endfor %}
                        </ul>
                    </ul>
                </div>
                <div id="page-content-wrapper">
                    <div class="page-content">
                        <div class="container">
                            <div class="row">
                                <div class="col-md-12">
                                    <div class="col-md">
                                        <div class="container">
                                            <div class="row">
                                                <div class="col-md">
                                                    <!--                            -->
                                                    <!--  checkSetPasswords: START  -->
                                                    <!--                            -->
                                                    <div class="container border shadow-3" id="checkSetPasswords">
                                                        {% if 'checkSetPasswords' in dct['xr_lst'] and dct['xr_lst']['checkSetPasswords']['contents'] %}
                                                        {% set temp_dct = dct['xr_lst']['checkSetPasswords'] %}
                                                        <h2>Checking password hashes against common passwords</h2>
                                                        <p style="font-weight:bold">Cracked passwords</p>
                                                        {% set formatted_dct = namespace(dct={}) %}
                                                        {% set csp_lines = (temp_dct['contents'].values() | list)[0] %}
                                                        {% for line in csp_lines %}
                                                        {% if line != csp_lines[1] and line != csp_lines[-1] %}
                                                        {% if line[0] == '/' %}
                                                        {% set x=formatted_dct.dct.__setitem__(line, []) %}
                                                        {% else %}
                                                        {% set key = (formatted_dct.dct.keys() | list)[-1] %}
                                                        {% set x=formatted_dct.dct.__setitem__(key, formatted_dct.dct[key] + [line[4:]]) %}
                                                        {% endif %}
                                                        {% endif %}
                                                        {% endfor %}
                                                        <!-- Modal here -->
                                                        <button type="button" class="btn btn-primary waves-effect waves-light" data-mdb-toggle="modal" data-mdb-target="#checkSetPasswordsModal" style="float: right">
                                                            View Raw
                                                        </button>
                                                        <div class="modal fade" id="checkSetPasswordsModal" tabindex="-1" role="dialog" aria-labelledby="checkSetPasswordsModalLabel">
                                                            <div class="modal-dialog modal-xl" role="document">
                                                                <div class="modal-content">
                                                                    <div class="modal-header">
                                                                        <h5 class="modal-title" id="checkSetPasswordsModalLabel">Checking password hashes against common passwords (Raw)</h5>
                                                                        <button type="button" class="btn-close" data-mdb-dismiss="modal" aria-label="Close"></button>
                                                                    </div>
                                                                    <div class="modal-body">
                                                                        <div class="code-toolbar">
                                                        <pre class="language-bash line-numbers"><code>{% for key in temp_dct['contents'] %}{{ "- " + key + " -\n" }}{% for line in temp_dct['contents'][key] %}{{ line + "\n" }}{% endfor %}{% endfor %}</code>
                                                        </pre>
                                                                        </div>
                                                                    </div>
                                                                    <div class="modal-footer">
                                                                        <button type="button" class="btn btn-secondary" data-mdb-dismiss="modal">Close</button>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <!-- Modal closed -->
                                                        <div class="container border shadow-3">
                                                            <table class="table">
                                                                <thead>
                                                                <tr>
                                                                    <th scope="col">.</th>
                                                                    <th>{{ csp_lines[1][1:].lstrip().split()[0] }}</th>
                                                                    <th>{{ csp_lines[1][1:].lstrip().split()[1] }}</th>
                                                                </tr>
                                                                </thead>
                                                                <tbody class='list-group-item-danger'>
                                                                {% for file in formatted_dct.dct %}
                                                                <tr class='list-group-item-danger'>
                                                                    <th scope="row" rowspan="{{ formatted_dct.dct[file] | length  + 1 }}">{{ file }}</th>
                                                                </tr>
                                                                {% for entry in  formatted_dct.dct[file] %}
                                                                <tr class='list-group-item-danger'>
                                                                    <td>{{ entry.lstrip().split()[0] }}</td>
                                                                    <td>{{ entry.lstrip().split()[1] }}</td>
                                                                </tr>
                                                                {% endfor %}
                                                                {% endfor %}
                                                                </tbody>
                                                            </table>
                                                            <br><br>
                                                            <p>{{ csp_lines[-1] }}</p>
                                                        </div>
                                                        {% endif %}
                                                    </div>
                                                    <!--                          -->
                                                    <!--  checkSetPasswords: END  -->
                                                    <!--                          -->
                                                </div>
                                            </div>
                                            <div class="row">
                                                <div class="col-md">
                                                    <div class="container border shadow-3" id="xr_lst_1">
                                                        <h2>Boot-related Configurations</h2>
                                                        <ul class="nav nav-tabs" id="Additional_Scripts-myTab" role="tablist">
                                                            {% set boot_related_configs = {'startup_mode': 'Boot-into mode', 'apparmor_raspbian': 'Apparmor', 'pi_services_interfaces': 'Pi-configurable Services'} %}
                                                            {% set brc_temp = namespace(counter=0) %}
                                                            {% for tab in boot_related_configs %}
                                                            {% if tab in dct['xr_lst'] and dct['xr_lst'][tab] %}
                                                            {% if brc_temp.counter == 0 %}
                                                            <li class="nav-item active" role="presentation">
                                                                <a
                                                                        class="nav-link active"
                                                                        aria-selected="true"
                                                                        {% else %}
                                                            <li class="nav-item" role="presentation">
                                                                <a
                                                                        class="nav-link"
                                                                        aria-selected="false"
                                                                        {% endif %}
                                                                        id="brc_{{ brc_temp.counter }}-tab"
                                                                        data-mdb-toggle="tab"
                                                                        href="#brc_{{ brc_temp.counter }}"
                                                                        role="tab"
                                                                        aria-controls="brc_{{ brc_temp.counter }}"
                                                                >{{ boot_related_configs[tab] }}</a>
                                                            </li>
                                                            {% set brc_temp.counter = brc_temp.counter + 1 %}
                                                            {% endif %}
                                                            {% endfor %}
                                                        </ul>

                                                        <section class="border p-4 text-center mb-4">
                                                            <div class="tab-content">
                                                                {% set brc_temp = namespace(counter=0) %}
                                                                {% for tab in boot_related_configs %}
                                                                {% if brc_temp.counter == 0 %}
                                                                <div class="tab-pane active" role="tabpanel" aria-labelledby="brc_{{ brc_temp.counter }}-tab" id="brc_{{ brc_temp.counter }}">
                                                                    {% else %}
                                                                    <div class="tab-pane fade" role="tabpanel" aria-labelledby="brc_{{ brc_temp.counter }}-tab" id="brc_{{ brc_temp.counter }}">
                                                                        {% endif %}
                                                                        {% set temp_dct = dct['xr_lst'][tab] %}
                                                                        <h2>{{ boot_related_configs[tab] }}</h2>
                                                                        <!-- Modal here -->
                                                                        <button type="button" class="btn btn-primary waves-effect waves-light" data-mdb-toggle="modal" data-mdb-target="#brc_{{ brc_temp.counter }}Modal" style="float: right">
                                                                            View Raw
                                                                        </button>
                                                                        <div class="modal fade" id="brc_{{ brc_temp.counter }}Modal" tabindex="-1" role="dialog" aria-labelledby="brc_{{ brc_temp.counter }}ModalLabel">
                                                                            <div class="modal-dialog modal-xl" role="document">
                                                                                <div class="modal-content">
                                                                                    <div class="modal-header">
                                                                                        <h5 class="modal-title" id="brc_{{ brc_temp.counter }}ModalLabel">Boot-into mode</h5>
                                                                                        <button type="button" class="btn-close" data-mdb-dismiss="modal" aria-label="Close"></button>
                                                                                    </div>
                                                                                    <div class="modal-body">
                                                                                        <div class="code-toolbar">
                                                                    <pre class="language-bash line-numbers"><code>{% for key in temp_dct['contents'] %}{{ "- " + key + " -\n" }}{% for line in temp_dct['contents'][key] %}{{ line + "\n" }}{% endfor %}{% endfor %}</code>
                                                                    </pre>
                                                                                        </div>
                                                                                    </div>
                                                                                    <div class="modal-footer">
                                                                                        <button type="button" class="btn btn-secondary" data-mdb-dismiss="modal">Close</button>
                                                                                    </div>
                                                                                </div>
                                                                            </div>
                                                                        </div>
                                                                        <!-- Modal closed -->
                                                                        <br><br>

                                                                        <div class="container border shadow-3">
                                                                            {% set temp_dct = dct['xr_lst'][tab] %}
                                                                            {% if tab == 'startup_mode' %}
                                                                            <div class="container">
                                                                                <div class="row">
                                                                                    <div class="col-md">
                                                                                        <ul class="list-group">
                                                                                            <li class="list-group-item {% if temp_dct['contents']['Boot-into mode'][0][:3] == '(!)' %}list-group-item-danger{% else %}list-group-item-info{% endif %}">Startup mode</li>
                                                                                            {% for line in temp_dct['contents']['Boot-into mode'] %}
                                                                                            <li class="list-group-item list-group-item">{{ line }}</li>
                                                                                            {% endfor %}
                                                                                        </ul>
                                                                                    </div>

                                                                                    <div class="col-md">
                                                                                        <ul class="list-group">
                                                                                            <li class="list-group-item list-group-item-{% if temp_dct['contents']['Auto Login'] %}danger{% else %}success{% endif %}">Auto Login</li>
                                                                                            {% if temp_dct['contents']['Auto Login'] %}
                                                                                            {% for line in temp_dct['contents']['Auto Login'] %}
                                                                                            <li class="list-group-item list-group-item">{{ line }}</li>
                                                                                            {% endfor %}
                                                                                            {% else %}
                                                                                            <li class="list-group-item list-group-item">NIL</li>
                                                                                            {% endif %}
                                                                                        </ul>
                                                                                    </div>
                                                                                </div>

                                                                                <div class="row">
                                                                                    <div class="col-md">
                                                                                        <ul class="list-group">
                                                                                            <li class="list-group-item {% if temp_dct['contents']['Network Boot'][0][:3] == '(!)' %}list-group-item-danger{% else %}list-group-item-info{% endif %}">Network Boot:</li>
                                                                                            {% for line in temp_dct['contents']['Network Boot'] %}
                                                                                            <li class="list-group-item list-group-item">{{ line }}</li>
                                                                                            {% endfor %}
                                                                                        </ul>
                                                                                    </div>

                                                                                    <div class="col-md">
                                                                                        <ul class="list-group">
                                                                                            <li class="list-group-item {% if temp_dct['contents']['Splash Screen'][0][:3] == '(!)' %}list-group-item-danger{% else %}list-group-item-success{% endif %}">Splash Screen:</li>
                                                                                            {% for line in temp_dct['contents']['Splash Screen'] %}
                                                                                            <li class="list-group-item list-group-item">{{ line }}</li>
                                                                                            {% endfor %}
                                                                                        </ul>
                                                                                    </div>
                                                                                </div>
                                                                            </div>
                                                                            {% elif tab == 'apparmor_raspbian' %}
                                                                            <div class="container">
                                                                                <div class="row">
                                                                                    <div class="col-md">
                                                                                        <ul class="list-group">
                                                                                            {% if temp_dct['contents']['Installation Status'] %}
                                                                                            <li class="list-group-item list-group-item-success">Installation Status:</li>
                                                                                            {% for line in temp_dct['contents']['Installation Status'] %}
                                                                                            <li class="list-group-item">{{ line }}</li>
                                                                                            {% endfor %}
                                                                                            {% else %}
                                                                                            <li class="list-group-item list-group-item-danger">Installation Status:</li>
                                                                                            <li class="list-group-item">Not installed</li>
                                                                                            {% endif %}
                                                                                        </ul>
                                                                                    </div>

                                                                                    <div class="col-md">
                                                                                        <ul class="list-group">
                                                                                            {% if temp_dct['contents']['Installation Status'] %}
                                                                                            <li class="list-group-item list-group-item-{% if temp_dct['contents']['In Bootloader Configuration Status'][0][:3] == '(!)' %}danger{% else %}success{% endif %}">In Bootloader Configuration Status:</li>
                                                                                            {% for line in temp_dct['contents']['In Bootloader Configuration Status'] %}
                                                                                            <li class="list-group-item"><b>{{ line.split(',')[0] }}</b><br>{% if line.split(',')|length > 1 %}{{ ',\n'.join(line.split(',')[1:]) }}{% endif %}</li>
                                                                                            {% endfor %}
                                                                                            {% else %}
                                                                                            <li class="list-group-item list-group-item-danger">In Bootloader Configuration Status:</li>
                                                                                            <li class="list-group-item">NIL</li>
                                                                                            {% endif %}
                                                                                        </ul>
                                                                                    </div>
                                                                                </div>

                                                                                <div class="row">
                                                                                    <div class="col-md">
                                                                                        <ul class="list-group">
                                                                                            {% if temp_dct['contents']['Installation Status'] %}
                                                                                            <li class="list-group-item list-group-item-success">AppArmor Profile Status:</li>
                                                                                            {% for line in temp_dct['contents']['AppArmor Profile Status'] %}
                                                                                            <li class="list-group-item">{{ line }}</li>
                                                                                            {% endfor %}
                                                                                            {% else %}
                                                                                            <li class="list-group-item list-group-item-danger">AppArmor Profile Status:</li>
                                                                                            <li class="list-group-item">NIL</li>
                                                                                            {% endif %}
                                                                                        </ul>
                                                                                    </div>
                                                                                </div>
                                                                            </div>
                                                                            {% elif tab == 'pi_services_interfaces' %}
                                                                            <div class="container">
                                                                                {% set psi_dct = {'Disabled': [], 'Enabled': []} %}
                                                                                {% for line in temp_dct['contents'][(temp_dct['contents']|list)[0]] %}
                                                                                {% if line.split()[-1] == 'enabled' %}
                                                                                {% set x=psi_dct.__setitem__('Enabled', psi_dct['Enabled']+[' '.join(line.split()[:-1])]) %}
                                                                                {% else %}
                                                                                {% set x=psi_dct.__setitem__('Disabled', psi_dct['Disabled']+[' '.join(line.split()[:-1])]) %}
                                                                                {% endif %}
                                                                                {% endfor %}
                                                                                <div class="row">
                                                                                    {% for key in psi_dct %}
                                                                                    <div class="col-md">
                                                                                        <ul class="list-group">
                                                                                            <li class="list-group-item {{ ['list-group-item-success', 'list-group-item-danger'][(psi_dct|list).index(key)] }}">{{ key }}</li>
                                                                                            {% for line in psi_dct[key] %}
                                                                                            <li class="list-group-item">{{ line }}</li>
                                                                                            {% endfor %}
                                                                                        </ul>
                                                                                    </div>
                                                                                    {% endfor %}
                                                                                </div>
                                                                            </div>
                                                                            {% endif %}
                                                                        </div>
                                                                    </div>
                                                                    {% set brc_temp.counter = brc_temp.counter + 1 %}
                                                                    {% endfor %}
                                                                </div>
                                                            </div>
                                                        </section>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="row">
                                                <div class="col-md">
                                                    <div class="container border shadow-3" id="xr_lst_2">
                                                        <h2>GUI-related configurations</h2>
                                                        <ul class="nav nav-tabs" id="Additional_Scripts-myTab1" role="tablist">
                                                            {% set gui_related_configs = {'gui_display': 'GUI Display', 'gui_automount': 'GUI USB Auto-mounting'} %}
                                                            {% set gui_related_temp = namespace(counter=0) %}
                                                            {% for tab in gui_related_configs %}
                                                            {% if tab in dct['xr_lst'] and dct['xr_lst'][tab] %}
                                                            {% if gui_related_temp.counter == 0 %}
                                                            <li class="nav-item active" role="presentation">
                                                                <a
                                                                        class="nav-link active"
                                                                        aria-selected="true"
                                                                        {% else %}
                                                            <li class="nav-item" role="presentation">
                                                                <a
                                                                        class="nav-link"
                                                                        aria-selected="false"
                                                                        {% endif %}
                                                                        id="gui_{{ gui_related_temp.counter }}-tab"
                                                                        data-mdb-toggle="tab"
                                                                        href="#gui_{{ gui_related_temp.counter }}"
                                                                        role="tab"
                                                                        aria-controls="gui_{{gui_related_temp.counter }}"
                                                                >{{ gui_related_configs[tab] }}</a>
                                                            </li>
                                                            {% set gui_related_temp.counter = gui_related_temp.counter + 1 %}
                                                            {% endif %}
                                                            {% endfor %}
                                                        </ul>

                                                        <section class="border p-4 text-center mb-4">
                                                            <div class="tab-content">
                                                                {% set gui_related_temp = namespace(counter=0) %}
                                                                {% for tab in gui_related_configs %}
                                                                {% if gui_related_temp.counter == 0 %}
                                                                <div class="tab-pane active" role="tabpanel" aria-labelledby="gui_{{ gui_related_temp.counter }}-tab" id="gui_{{ gui_related_temp.counter }}">
                                                                    {% else %}
                                                                    <div class="tab-pane fade" role="tabpanel" aria-labelledby="gui_{{ gui_related_temp.counter }}-tab" id="gui_{{ gui_related_temp.counter }}">
                                                                        {% endif %}
                                                                        {% set temp_dct = dct['xr_lst'][tab] %}
                                                                        <h2>{{ temp_dct['title'] }}</h2>
                                                                        <!-- Modal here -->
                                                                        <button type="button" class="btn btn-primary waves-effect waves-light" data-mdb-toggle="modal" data-mdb-target="#gui_{{ gui_related_temp.counter }}Modal" style="float: right">
                                                                            View Raw
                                                                        </button>
                                                                        <div class="modal fade" id="gui_{{ gui_related_temp.counter }}Modal" tabindex="-1" role="dialog" aria-labelledby="gui_{{ gui_related_temp.counter }}ModalLabel">
                                                                            <div class="modal-dialog modal-xl" role="document">
                                                                                <div class="modal-content">
                                                                                    <div class="modal-header">
                                                                                        <h5 class="modal-title" id="gui_{{ gui_related_temp.counter }}ModalLabel">Boot-into mode</h5>
                                                                                        <button type="button" class="btn-close" data-mdb-dismiss="modal" aria-label="Close"></button>
                                                                                    </div>
                                                                                    <div class="modal-body">
                                                                                        <div class="code-toolbar">
                                                                    <pre class="language-bash line-numbers"><code>{% for key in temp_dct['contents'] %}{{ "- " + key + " -\n" }}{% for line in temp_dct['contents'][key] %}{{ line + "\n" }}{% endfor %}{% endfor %}</code>
                                                                    </pre>
                                                                                        </div>
                                                                                    </div>
                                                                                    <div class="modal-footer">
                                                                                        <button type="button" class="btn btn-secondary" data-mdb-dismiss="modal">Close</button>
                                                                                    </div>
                                                                                </div>
                                                                            </div>
                                                                        </div>
                                                                        <!-- Modal closed -->
                                                                        <br><br>

                                                                        <div class="container border shadow-3">
                                                                            {% set temp_dct = dct['xr_lst'][tab] %}
                                                                            {% if tab == 'gui_display' %}
                                                                            <div class="container">
                                                                                <div class="row">
                                                                                    <div class="col-md">
                                                                                        <ul class="list-group">
                                                                                            <li class="list-group-item {% if temp_dct['contents']['(Bootloader) OpenGL Driver'][0][:3] == '(!)' %}list-group-item-danger{% else %}list-group-item-info{% endif %}">(Bootloader) OpenGL Driver</li>
                                                                                            {% for line in temp_dct['contents']['(Bootloader) OpenGL Driver'] %}
                                                                                            <li class="list-group-item list-group-item">{{ line }}</li>
                                                                                            {% endfor %}
                                                                                        </ul>
                                                                                    </div>
                                                                                    <div class="col-md">
                                                                                        <ul class="list-group">
                                                                                            <li class="list-group-item {% if temp_dct['contents']['HDMI'][0][:3] == '(!)' %}list-group-item-danger{% else %}list-group-item-info{% endif %}">HDMI</li>
                                                                                            <li class="list-group-item list-group-item">{% if temp_dct['contents']['HDMI'][0][:3] == '(!)' %}<b>{{ temp_dct['contents']['HDMI'][0].split(' - ')[0] }}</b>{% else %}{{ temp_dct['contents']['HDMI'][0].split(' - ')[0] }}{% endif %}<br>{% if temp_dct['contents']['HDMI'][0].split(' - ')|length > 1 %}{{ ',\n'.join(temp_dct['contents']['HDMI'][0].split(' - ')[1:]) }}{% endif %}</li>
                                                                                        </ul>
                                                                                    </div>
                                                                                    <div class="col-md">
                                                                                        <ul class="list-group">
                                                                                            <li class="list-group-item list-group-item-info">Composite</li>
                                                                                            <li class="list-group-item {% if temp_dct['contents']['Composite'][0].split()[-1] | int > 0 %}list-group-item-danger{% else %}list-group-item{% endif %}">Number of displays: {{ temp_dct['contents']['Composite'][0].split()[-1] }}</li>
                                                                                            <li class="list-group-item {% if temp_dct['contents']['Composite'][1][:3] == '(!)' %}list-group-item-warning{% else %}list-group-item{% endif %}">{{ '<br>'.join(temp_dct['contents']['Composite'][1:]) }}</li>
                                                                                        </ul>
                                                                                    </div>
                                                                                </div>
                                                                            </div>
                                                                            {% elif tab == 'gui_automount' %}
                                                                            <table class="table">
                                                                                <thead>
                                                                                <tr>
                                                                                    {% for item in (temp_dct['contents'].values() | list)[0][0].split() %}
                                                                                    <th>{{ item }}</th>
                                                                                    {% endfor %}
                                                                                </tr>
                                                                                </thead>
                                                                                <tbody>
                                                                                {% for row in (temp_dct['contents'].values() | list)[0][1:-1] %}
                                                                                    {% set temp = row.split() %}
                                                                                <tr class="list-group-item-{% if temp | length > 2 %}danger{% else %}success{% endif %}">
                                                                                    <td>{{ temp[0] }}</td>
                                                                                    <td>{{ temp[1] }}</td>
                                                                                    <td>{% if temp | length > 2 %}{{ ', '.join(temp[2:]) }}{% endif %}</td>
                                                                                </tr>
                                                                                {% endfor %}
                                                                                </tbody>
                                                                            </table>
                                                                            {% endif %}
                                                                        </div>
                                                                    </div>
                                                                    {% set gui_related_temp.counter = gui_related_temp.counter + 1 %}
                                                                    {% endfor %}


                                                                    <div class="tab-pane fade" role="tabpanel" aria-labelledby="audio_output_interfaces-tab" id="audio_output_interfaces">
                                                                        <ul class="list-group">
                                                                            <li class="list-group-item list-group-item-info">No soundcards detected</li>
                                                                        </ul>
                                                                    </div>
                                                                </div>
                                                        </section>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="row">
                                                <div class="col-md">
                                                    <div class="container border shadow-3" id="xr_lst_3">
                                                        <h2>Check for certain installed Packages</h2>
                                                        <section class="border p-4 text-center mb-4">
                                                            <h4>Check for specific packages' installations</h4>
                                                            {% set pkg_checker = namespace(dct={}) %}

                                                            {% set temp_dct = dct['xr_lst']['checkRecommendedPackages']['contents'] %}
                                                            {% for line in temp_dct[(temp_dct|list)[0]][1:-1] %}
                                                            {% set x=pkg_checker.dct.__setitem__(line.split()[0], [line.split()[1]]) %}
                                                            {% endfor %}

                                                            {% set temp_dct = dct['xr_lst']['checkRecommendedPackages_configs']['contents'] %}
                                                            {% set last = namespace(key='', config_dct={}) %}
                                                            {% for line in temp_dct[(temp_dct|list)[0]] %}
                                                            {% if line[0] != '|' %}
                                                            {% if last.key and last.config_dct %}
                                                            {% set x=pkg_checker.dct.__setitem__(last.key, pkg_checker.dct[last.key] + [last.config_dct]) %}
                                                            {% endif %}
                                                            {% set last.key = line %}
                                                            {% set last.config_dct = {} %}
                                                            {% elif line[:2] == '| ' %}
                                                            {% set x=pkg_checker.dct.__setitem__(last.key, pkg_checker.dct[last.key] + [line.split()[1]]) %}
                                                            {% elif line[:2] == '|-' %}
                                                            {% if line.split() | length > 3 %}
                                                            {% set x=last.config_dct.__setitem__(line.split()[1], [line.split()[2], line.split()[3]]) %}
                                                            {% else %}
                                                            {% set x=last.config_dct.__setitem__(line.split()[1], [line.split()[2]]) %}
                                                            {% endif %}
                                                            {% endif %}
                                                            {% endfor %}
                                                            {% if last.key and last.config_dct %}
                                                            {% set x=pkg_checker.dct.__setitem__(last.key, pkg_checker.dct[last.key] + [last.config_dct]) %}
                                                            {% endif %}
                                                            <!-- Modal here -->
                                                            <button type="button" class="btn btn-primary waves-effect waves-light" data-mdb-toggle="modal" data-mdb-target="#check_RecommendedPackagesModal" style="float: right">
                                                                View Raw
                                                            </button>
                                                            <div class="modal fade" id="check_RecommendedPackagesModal" tabindex="-1" role="dialog" aria-labelledby="check_RecommendedPackagesModalLabel">
                                                                <div class="modal-dialog modal-xl" role="document">
                                                                    <div class="modal-content">
                                                                        <div class="modal-header">
                                                                            <h5 class="modal-title" id="check_RecommendedPackagesModalLabel">Check for certain installed Packages</h5>
                                                                            <button type="button" class="btn-close" data-mdb-dismiss="modal" aria-label="Close"></button>
                                                                        </div>
                                                                        <div class="modal-body">
                                                                            <div class="code-toolbar">
                                                            <pre class="language-bash line-numbers"><code>{% for key in dct['xr_lst']['checkRecommendedPackages']['contents'] %}{{ "- " + key + " -\n" }}{% for line in dct['xr_lst']['checkRecommendedPackages']['contents'][key] %}{{ line + "\n" }}{% endfor %}{% endfor %}<br>
                                                            {% for key in dct['xr_lst']['checkRecommendedPackages_configs']['contents'] %}{{ "- " + key + " -\n" }}{% for line in dct['xr_lst']['checkRecommendedPackages_configs']['contents'][key] %}{{ line + "\n" }}{% endfor %}{% endfor %}</code>
                                                            </pre>
                                                                            </div>
                                                                        </div>
                                                                        <div class="modal-footer">
                                                                            <button type="button" class="btn btn-secondary" data-mdb-dismiss="modal">Close</button>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <!-- Modal closed -->
                                                            <table class="table">
                                                                <thead class="table-light">
                                                                <tr>
                                                                    <th scope="row">Package</th>
                                                                    <th scope="row">Config file</th>
                                                                    <th scope="row">Compliance</th>
                                                                    <th scope="row"># of Violations</th>
                                                                </tr>
                                                                </thead>
                                                                <tbody>
                                                                {% for package in pkg_checker.dct %}
                                                                <tr>
                                                                    <th rowspan="{{ pkg_checker.dct[package][2] | length + 1 }}">
                                                                        {{ package }}
                                                                        <span class="badge {% if pkg_checker.dct[package][0] == 'TRUE' %}list-group-item-info{% else %}list-group-item-danger{% endif %} rounded-pill">{% if pkg_checker.dct[package][0] == 'TRUE' %}Installed{% else %}Not Detected{% endif %}</span>
                                                                        <!-- <span class="badge {% if pkg_checker.dct[package][1].split('/')[0] == pkg_checker.dct[package][1].split('/')[1] %}list-group-item-info{% else %}list-group-item-warning{% endif %} rounded-pill">{{ pkg_checker.dct[package][1] }}</span> -->
                                                                    </th>
                                                                </tr>
                                                                {% for config_file in pkg_checker.dct[package][2] %}
                                                                <tr class="{% if pkg_checker.dct[package][2][config_file][0] == 'UNCOMPLIANT' %}list-group-item-success{% elif pkg_checker.dct[package][2][config_file][0] == 'NIL' %}#e0d392{% else %}list-group-item-danger{% endif %}">
                                                                    <td>{{ config_file }}</td>
                                                                    <td>{% if pkg_checker.dct[package][2][config_file][0] == 'NIL' %}{{ 'No rules supplied' }}{% else %}{{ pkg_checker.dct[package][2][config_file][0] }}{% endif %}</td>
                                                                    <td>{% if pkg_checker.dct[package][2][config_file] | length > 1 %}{{ pkg_checker.dct[package][2][config_file][1] | string + ' unmatched lines' }}{% endif %}</td>
                                                                </tr>
                                                                {% endfor %}
                                                                {% endfor %}
                                                                </tbody>
                                                            </table>
                                                        </section>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="container">
            </div>
        </div>
        {% endif %}
    </div>
</body>

<!-- Bootstrap   --><script type="text/javascript" src="../../scripts/html_templating/templates/js/bootstrap/bootstrap.min.js"></script>
<!-- MDB         --><script type="text/javascript" src="../../scripts/html_templating/templates/js/mdb.min.js"></script>
<!-- PRISM       --><script type="text/javascript" src="../../scripts/html_templating/templates/js/prism.js"></script>
<!-- MDB SNIPPET --><script type="text/javascript" src="../../scripts/html_templating/templates/js/dist/mdbsnippet.min.js"></script>
<!-- Popper      --><script type="text/javascript" src="../../scripts/html_templating/templates/js/popper.min.js"></script>
</html>
